(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4128],{1243:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(19946).A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},12767:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(19946).A)("chevrons-right",[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]])},13052:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(19946).A)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},14186:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(19946).A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},23227:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(19946).A)("building-2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]])},29869:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(19946).A)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]])},31445:(e,s,a)=>{Promise.resolve().then(a.bind(a,65705))},35169:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(19946).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},40646:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(19946).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},42355:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(19946).A)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},43453:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(19946).A)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},47924:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(19946).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},52278:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(19946).A)("chevrons-left",[["path",{d:"m11 17-5-5 5-5",key:"13zhaf"}],["path",{d:"m18 17-5-5 5-5",key:"h8a8et"}]])},55868:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(19946).A)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},65705:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>ed});var t=a(95155),r=a(12115),l=a(91165),n=a(19018),i=a(30285),c=a(22346),d=a(3501),o=a(23861),m=a(42143),x=a(66695),u=a(62523),h=a(47924);let p=e=>{let{searchTerm:s,onSearch:a}=e,[l,n]=(0,r.useState)(s);return(0,t.jsx)(x.Zp,{className:"w-full",children:(0,t.jsx)(x.Wu,{className:"",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(h.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),(0,t.jsx)(u.p,{type:"text",placeholder:"Buscar empresas por nombre, RUC o raz\xf3n social...",value:l,onChange:e=>(e=>{n(e),a(e)})(e.target.value),className:"pl-10 h-12 text-base"})]})})})};var g=a(26126),j=a(23227),N=a(13052),f=a(71007),v=a(52278),y=a(42355),A=a(12767);let b=e=>{let{companies:s,onCompanyClick:a,isLoading:r,paginationMeta:l,onPageChange:n,onPageSizeChange:c,filters:d}=e;if(r)return(0,t.jsx)("div",{className:"space-y-6",children:(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((e,s)=>(0,t.jsxs)(x.Zp,{className:"animate-pulse",children:[(0,t.jsxs)(x.aR,{children:[(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),(0,t.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]}),(0,t.jsx)(x.Wu,{children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"h-3 bg-gray-200 rounded"}),(0,t.jsx)("div",{className:"h-3 bg-gray-200 rounded w-2/3"})]})})]},s))})});if(0===s.length)return(0,t.jsx)(x.Zp,{className:"col-span-full",children:(0,t.jsxs)(x.Wu,{className:"p-8 text-center",children:[(0,t.jsx)(j.A,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No tienes empresas asignadas"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:(null==d?void 0:d.search)?"No se encontraron empresas que coincidan con tu b\xfasqueda":"Cuando se te asignen empresas, aparecer\xe1n aqu\xed"})]})});let o=!!l&&(void 0!==l.hasPrevious?l.hasPrevious:l.page>1),m=!!l&&(void 0!==l.hasNext?l.hasNext:l.page<l.totalPages);return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(e=>(0,t.jsxs)(x.Zp,{className:"cursor-pointer hover:shadow-lg transition-all duration-200 group",onClick:()=>a(e.id),children:[(0,t.jsxs)(x.aR,{className:"pb-3",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsx)(x.ZB,{className:"text-lg font-semibold line-clamp-2 group-hover:text-primary transition-colors",children:e.businessName}),(0,t.jsx)(N.A,{className:"h-5 w-5 text-muted-foreground group-hover:text-primary transition-colors flex-shrink-0 ml-2"})]}),e.tradeName&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground line-clamp-2 mt-1",children:e.tradeName}),(0,t.jsx)(g.E,{variant:e.isActive?"default":"secondary",className:"w-fit",children:e.isActive?"Activa":"Inactiva"})]}),(0,t.jsxs)(x.Wu,{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center text-sm text-muted-foreground",children:[(0,t.jsx)(j.A,{className:"h-4 w-4 mr-2 flex-shrink-0"}),(0,t.jsx)("span",{className:"line-clamp-1",children:e.ruc})]}),(0,t.jsxs)("div",{className:"flex items-center text-sm text-muted-foreground",children:[(0,t.jsx)(f.A,{className:"h-4 w-4 mr-2 flex-shrink-0"}),(0,t.jsx)("span",{className:"line-clamp-1",children:e.contactName})]})]})]},e.id))}),l&&s.length>0&&(0,t.jsx)("div",{className:"pt-4 border-t",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 items-center gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-center sm:justify-start gap-2 text-sm order-2 sm:order-1",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Mostrar:"}),(0,t.jsxs)("select",{value:(null==d?void 0:d.limit)||6,onChange:e=>c&&c(Number(e.target.value)),className:"h-8 px-2 text-sm border border-input bg-background rounded-md focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",children:[(0,t.jsx)("option",{value:6,children:"6"}),(0,t.jsx)("option",{value:12,children:"12"}),(0,t.jsx)("option",{value:24,children:"24"}),(0,t.jsx)("option",{value:48,children:"48"})]}),(0,t.jsx)("span",{className:"text-muted-foreground",children:"por p\xe1gina"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-center gap-1 order-1 sm:order-2",children:[(0,t.jsx)(i.$,{variant:"outline",size:"sm",onClick:()=>{l&&l.page>1&&n&&n(1)},disabled:!o,className:"h-8 w-8 p-0",title:"Primera p\xe1gina",children:(0,t.jsx)(v.A,{className:"h-4 w-4"})}),(0,t.jsxs)(i.$,{variant:"outline",size:"sm",onClick:()=>{l&&l.page>1&&n&&n(l.page-1)},disabled:!o,className:"h-8 px-3",title:"P\xe1gina anterior",children:[(0,t.jsx)(y.A,{className:"h-4 w-4 mr-1"}),(0,t.jsx)("span",{className:"hidden md:inline",children:"Anterior"})]}),(0,t.jsx)("div",{className:"flex items-center px-3",children:(0,t.jsxs)("span",{className:"text-sm font-medium whitespace-nowrap",children:[l.page," / ",l.totalPages||Math.ceil(l.total/((null==d?void 0:d.limit)||6))]})}),(0,t.jsxs)(i.$,{variant:"outline",size:"sm",onClick:()=>{l&&l.page<l.totalPages&&n&&n(l.page+1)},disabled:!m,className:"h-8 px-3",title:"P\xe1gina siguiente",children:[(0,t.jsx)("span",{className:"hidden md:inline",children:"Siguiente"}),(0,t.jsx)(N.A,{className:"h-4 w-4 ml-1"})]}),(0,t.jsx)(i.$,{variant:"outline",size:"sm",onClick:()=>{l&&l.page<l.totalPages&&n&&n(l.totalPages)},disabled:!m,className:"h-8 w-8 p-0",title:"\xdaltima p\xe1gina",children:(0,t.jsx)(A.A,{className:"h-4 w-4"})})]}),(0,t.jsx)("div",{className:"flex justify-center sm:justify-end order-3",children:(0,t.jsxs)("div",{className:"text-sm text-muted-foreground text-center sm:text-right",children:["Mostrando ",(l.page-1)*((null==d?void 0:d.limit)||6)+1," a"," ",Math.min(l.page*((null==d?void 0:d.limit)||6),l.total)," de ",l.total]})})]})})]})};var w=a(35169),k=a(4516),E=a(19420),P=a(28883),C=a(55868),D=a(14186),M=a(40646),S=a(85339),I=a(69074),R=a(92657),L=a(29869),z=a(31455),T=a(13439),O=a(62177),F=a(90221),q=a(73162),B=a(54165),H=a(17759),Z=a(59409),G=a(26715),V=a(5041),$=a(90697);class _{async createPayment(e){return await $.q.post("/payments",e)}}let K=new _;var W=a(87481);let Y={all:["accounting-payments"],lists:()=>[...Y.all,"list"],byInstallment:e=>[...Y.lists(),"installment",e]};var J=function(e){return e.PENDING="PENDING",e.COMPLETED="COMPLETED",e.FAILED="FAILED",e}({}),Q=function(e){return e.CASH="CASH",e.BANK_TRANSFER="BANK_TRANSFER",e.CARD="CARD",e.YAPE="YAPE",e.PLIN="PLIN",e.OTHER="OTHER",e}({});let U=q.Ik({amount:q.ai().min(.01,"El monto debe ser mayor a 0"),currency:q.k5(["PEN","USD"],{message:"Selecciona una moneda v\xe1lida"}),method:q.fc(Q,{message:"Selecciona un m\xe9todo de pago"}),reference:q.Yj().optional()}),X={[Q.CASH]:"Efectivo",[Q.BANK_TRANSFER]:"Transferencia Bancaria",[Q.CARD]:"Tarjeta",[Q.YAPE]:"Yape",[Q.PLIN]:"Plin",[Q.OTHER]:"Otro"},ee=[{value:"PEN",label:"PEN - Soles"},{value:"USD",label:"USD - D\xf3lares"}];function es(e){let{open:s,onOpenChange:a,installmentId:r,installmentAmount:l,installmentCurrency:n}=e,c=(()=>{let e=(0,G.useQueryClient)(),{showSuccess:s,showError:a}=(0,W.d)();return(0,V.useMutation)({mutationFn:e=>K.createPayment(e),onSuccess:async(a,t)=>(await e.invalidateQueries({queryKey:Y.byInstallment(t.installmentId)}),await e.invalidateQueries({queryKey:Y.all}),await e.invalidateQueries({predicate:e=>"accounting-clients"===e.queryKey[0]}),await e.refetchQueries({predicate:e=>"accounting-clients"===e.queryKey[0],type:"active"}),s("created",{title:"Pago enviado",description:"El pago ha sido enviado para verificaci\xf3n exitosamente"}),a),onError:e=>{a("error",{title:"Error al enviar pago",description:(null==e?void 0:e.message)||"No se pudo enviar el pago para verificaci\xf3n"})}})})(),d=(0,O.mN)({resolver:(0,F.u)(U),defaultValues:{amount:l,currency:n,method:Q.BANK_TRANSFER,reference:""}}),o=async e=>{try{await c.mutateAsync({installmentId:r,...e}),d.reset(),a(!1)}catch(e){console.error("Error al crear el pago:",e)}},m=()=>{d.reset(),a(!1)};return(0,t.jsx)(B.lG,{open:s,onOpenChange:m,children:(0,t.jsxs)(B.Cf,{className:"sm:max-w-[500px]",children:[(0,t.jsxs)(B.c7,{children:[(0,t.jsx)(B.L3,{children:"Subir Comprobante de Pago"}),(0,t.jsx)(B.rr,{children:"Completa la informaci\xf3n del pago realizado. El pago ser\xe1 verificado por el equipo administrativo."})]}),(0,t.jsx)(H.lV,{...d,children:(0,t.jsxs)("form",{onSubmit:d.handleSubmit(o),className:"space-y-6",children:[(0,t.jsx)(H.zB,{control:d.control,name:"amount",render:e=>{let{field:s}=e;return(0,t.jsxs)(H.eI,{children:[(0,t.jsx)(H.lR,{children:"Monto"}),(0,t.jsx)(H.MJ,{children:(0,t.jsx)(u.p,{type:"number",step:"0.01",placeholder:"0.00",...s,onChange:e=>s.onChange(parseFloat(e.target.value)||0)})}),(0,t.jsx)(H.C5,{})]})}}),(0,t.jsx)(H.zB,{control:d.control,name:"currency",render:e=>{let{field:s}=e;return(0,t.jsxs)(H.eI,{children:[(0,t.jsx)(H.lR,{children:"Moneda"}),(0,t.jsxs)(Z.l6,{onValueChange:s.onChange,defaultValue:s.value,children:[(0,t.jsx)(H.MJ,{children:(0,t.jsx)(Z.bq,{children:(0,t.jsx)(Z.yv,{placeholder:"Seleccionar moneda"})})}),(0,t.jsx)(Z.gC,{children:ee.map(e=>(0,t.jsx)(Z.eb,{value:e.value,children:e.label},e.value))})]}),(0,t.jsx)(H.C5,{})]})}}),(0,t.jsx)(H.zB,{control:d.control,name:"method",render:e=>{let{field:s}=e;return(0,t.jsxs)(H.eI,{children:[(0,t.jsx)(H.lR,{children:"M\xe9todo de Pago"}),(0,t.jsxs)(Z.l6,{onValueChange:s.onChange,defaultValue:s.value,children:[(0,t.jsx)(H.MJ,{children:(0,t.jsx)(Z.bq,{children:(0,t.jsx)(Z.yv,{placeholder:"Seleccionar m\xe9todo"})})}),(0,t.jsx)(Z.gC,{children:Object.entries(X).map(e=>{let[s,a]=e;return(0,t.jsx)(Z.eb,{value:s,children:a},s)})})]}),(0,t.jsx)(H.C5,{})]})}}),(0,t.jsx)(H.zB,{control:d.control,name:"reference",render:e=>{let{field:s}=e;return(0,t.jsxs)(H.eI,{children:[(0,t.jsx)(H.lR,{children:"N\xfamero de Operaci\xf3n (Opcional)"}),(0,t.jsx)(H.MJ,{children:(0,t.jsx)(u.p,{placeholder:"Ingresa el n\xfamero de operaci\xf3n",...s})}),(0,t.jsx)(H.C5,{})]})}}),(0,t.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,t.jsx)(i.$,{type:"button",variant:"outline",onClick:m,disabled:c.isPending,children:"Cancelar"}),(0,t.jsx)(i.$,{type:"submit",disabled:c.isPending,children:c.isPending?"Enviando...":"Enviar Pago"})]})]})})]})})}var ea=a(54416),et=a(81586);let er={[J.PENDING]:"En Verificaci\xf3n",[J.COMPLETED]:"Aprobado",[J.FAILED]:"Rechazado"},el={[Q.CASH]:"Efectivo",[Q.BANK_TRANSFER]:"Transferencia Bancaria",[Q.CARD]:"Tarjeta",[Q.YAPE]:"Yape",[Q.PLIN]:"Plin",[Q.OTHER]:"Otro"};function en(e){let{open:s,onOpenChange:a,payments:r,installmentDescription:l="Cuota"}=e,n=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"PEN";return new Intl.NumberFormat("es-PE",{style:"currency",currency:s,minimumFractionDigits:2}).format(e)},i=e=>new Date(e).toLocaleDateString("es-PE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"});return(0,t.jsx)(B.lG,{open:s,onOpenChange:a,children:(0,t.jsxs)(B.Cf,{className:"sm:max-w-[600px] max-w-[95vw] max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)(B.c7,{children:[(0,t.jsxs)(B.L3,{className:"flex items-center gap-2",children:[(0,t.jsx)(et.A,{className:"h-5 w-5"}),"Pagos de ",l]}),(0,t.jsx)(B.rr,{children:"Detalle de los pagos realizados para esta cuota"})]}),(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"font-medium text-sm text-muted-foreground",children:"Historial de Pagos"}),r.length>0?(0,t.jsx)("div",{className:"space-y-3",children:r.map((e,s)=>(0,t.jsx)(x.Zp,{className:"border-l-4 ".concat("COMPLETED"===e.status?"border-l-green-500":"FAILED"===e.status?"border-l-red-500":"PENDING"===e.status?"border-l-yellow-500":"border-l-gray-500"),children:(0,t.jsx)(x.Wu,{className:"p-4",children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"h-10 w-10 rounded-full flex items-center justify-center ".concat("COMPLETED"===e.status?"bg-green-100 dark:bg-green-900/30":"FAILED"===e.status?"bg-red-100 dark:bg-red-900/30":"PENDING"===e.status?"bg-yellow-100 dark:bg-yellow-900/30":"bg-gray-100 dark:bg-gray-900/30"),children:(e=>{switch(e){case"COMPLETED":return(0,t.jsx)(M.A,{className:"h-4 w-4 text-green-600"});case"FAILED":return(0,t.jsx)(ea.A,{className:"h-4 w-4 text-red-600"});case"PENDING":return(0,t.jsx)(D.A,{className:"h-4 w-4 text-yellow-600"});default:return(0,t.jsx)(S.A,{className:"h-4 w-4 text-gray-600"})}})(e.status)}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"font-medium text-sm",children:["Pago #",s+1]}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[(0,t.jsx)(I.A,{className:"h-3 w-3"}),i(e.createdAt)]})]})]}),(0,t.jsx)("div",{className:"text-right",children:(0,t.jsx)(g.E,{className:(e=>{switch(e){case"COMPLETED":return"bg-green-100 dark:bg-green-900/20 text-green-800 dark:text-green-300";case"FAILED":return"bg-red-100 dark:bg-red-900/20 text-red-800 dark:text-red-300";case"PENDING":return"bg-yellow-100 dark:bg-yellow-900/20 text-yellow-800 dark:text-yellow-300";default:return"bg-gray-100 dark:bg-gray-900/20 text-gray-800 dark:text-gray-300"}})(e.status),children:er[e.status]})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground",children:"Monto"}),(0,t.jsx)("p",{className:"font-semibold",children:n(e.amount,e.currency)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground",children:"M\xe9todo"}),(0,t.jsx)("p",{className:"font-medium",children:el[e.method]||e.method})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground",children:"Nro. Operaci\xf3n"}),(0,t.jsx)("p",{className:"font-mono text-xs",children:e.reference||"No especificado"})]})]}),e.paidAt&&(0,t.jsxs)("div",{className:"pt-3 border-t text-sm",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Fecha de aprobaci\xf3n: "}),(0,t.jsx)("span",{className:"font-medium",children:i(e.paidAt)})]})]})})},e.id))}):(0,t.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,t.jsx)(et.A,{className:"h-12 w-12 mx-auto text-muted-foreground/50 mb-4"}),(0,t.jsx)("p",{className:"text-sm",children:"No hay pagos registrados para esta cuota"})]})]})})]})})}let ei=e=>{var s,a;let{company:l}=e,[n,c]=(0,r.useState)(!1),[d,o]=(0,r.useState)(!1),[m,u]=(0,r.useState)(null),h=((null==(a=l.contract)||null==(s=a.filter(e=>e.isActive))?void 0:s.flatMap(e=>{var s;return(null==(s=e.installments)?void 0:s.map(s=>({...s,contractId:e.id,contractUser:e.user,monthlyPayment:e.monthlyPayment})))||[]}))||[]).sort((e,s)=>new Date(e.dueDate).getTime()-new Date(s.dueDate).getTime());return 0===h.length?(0,t.jsxs)(x.Zp,{children:[(0,t.jsxs)(x.aR,{children:[(0,t.jsxs)(x.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(C.A,{className:"h-5 w-5"}),"Cuotas del Proyecto"]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Gestiona los pagos de cada cuota de tu proyecto"})]}),(0,t.jsxs)(x.Wu,{className:"p-8 text-center",children:[(0,t.jsx)(C.A,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No hay cuotas registradas"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Esta empresa no tiene cuotas registradas en contratos activos"})]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(x.Zp,{children:[(0,t.jsxs)(x.aR,{children:[(0,t.jsxs)(x.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(C.A,{className:"h-5 w-5"}),"Cuotas de la Empresa"]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Gestiona los pagos de cada cuota de la empresa"})]}),(0,t.jsx)(x.Wu,{children:(0,t.jsx)("div",{className:"space-y-4",children:h.map((e,s)=>{let a=(e=>{if(!e.payments||0===e.payments.length)return{status:"pending",label:"Pendiente",icon:D.A,variant:"secondary",iconColor:"text-orange-500"};let s=e.payments.some(e=>"COMPLETED"===e.status),a=e.payments.some(e=>"PENDING"===e.status),t=e.payments.some(e=>"FAILED"===e.status);return s?{status:"completed",label:"Pagado",icon:M.A,variant:"default",iconColor:"text-green-500"}:a?{status:"verification",label:"En Verificaci\xf3n",icon:D.A,variant:"outline",iconColor:"text-blue-500"}:t?{status:"failed",label:"Rechazado",icon:S.A,variant:"destructive",iconColor:"text-red-500"}:{status:"pending",label:"Pendiente",icon:D.A,variant:"secondary",iconColor:"text-orange-500"}})(e),r=a.icon,l=new Date(e.dueDate)<new Date&&"pending"===a.status,n="completed"===a.status||"verification"===a.status;return(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between p-4 border rounded-lg hover:bg-muted/50 transition-colors gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4 flex-1 min-w-0",children:[(0,t.jsx)("div",{className:"flex items-center justify-center w-10 h-10 rounded-full bg-muted flex-shrink-0",children:(0,t.jsx)(r,{className:"h-5 w-5 ".concat(a.iconColor)})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("h3",{className:"font-medium truncate",children:e.description||"Cuota #".concat(s+1)}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4 mt-1 text-sm text-muted-foreground",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(C.A,{className:"h-3 w-3 flex-shrink-0"}),(0,t.jsxs)("span",{children:["S/ ",e.amount.toLocaleString("es-PE",{minimumFractionDigits:2})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(I.A,{className:"h-3 w-3 flex-shrink-0"}),(0,t.jsx)("span",{className:l?"text-red-600":"",children:(0,z.GP)(new Date(e.dueDate),"dd/MM/yyyy",{locale:T.es})})]})]})]})]}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 sm:gap-4",children:[(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,t.jsx)(g.E,{variant:a.variant,children:a.label}),l&&(0,t.jsx)(g.E,{variant:"destructive",children:"Vencida"})]}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.payments&&e.payments.length>0&&(0,t.jsxs)(i.$,{variant:"outline",size:"sm",onClick:()=>{u(e),o(!0)},className:"w-full sm:w-auto",children:[(0,t.jsx)(R.A,{className:"h-4 w-4 mr-2"}),"Ver (",e.payments.length,")"]}),(0,t.jsxs)(i.$,{size:"sm",variant:n?"outline":"default",onClick:()=>{u(e),c(!0)},disabled:n,className:"w-full sm:w-auto",children:[(0,t.jsx)(L.A,{className:"h-4 w-4 mr-2"}),"verification"===a.status?"En Verificaci\xf3n":"Subir Pago"]})]})]})]},e.id)})})})]}),m&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(es,{open:n,onOpenChange:c,installmentId:m.id,installmentAmount:m.amount,installmentCurrency:"PEN"}),(0,t.jsx)(en,{open:d,onOpenChange:o,payments:m.payments||[],installmentDescription:m.description||"Cuota #".concat(h.indexOf(m)+1)})]})]})},ec=e=>{var s;let{company:a,onBack:r,isLoading:l}=e;if(l||!a)return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(i.$,{variant:"ghost",size:"sm",onClick:r,children:(0,t.jsx)(w.A,{className:"h-4 w-4"})}),(0,t.jsx)("div",{className:"h-8 bg-muted rounded w-1/3 animate-pulse"})]}),(0,t.jsx)(x.Zp,{className:"animate-pulse",children:(0,t.jsx)(x.Wu,{className:"p-6",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{className:"h-4 bg-muted rounded w-3/4"}),(0,t.jsx)("div",{className:"h-4 bg-muted rounded w-1/2"}),(0,t.jsx)("div",{className:"h-4 bg-muted rounded w-2/3"})]})})})]});let n=((null==(s=a.contract)?void 0:s.filter(e=>e.isActive))||[]).reduce((e,s)=>e+s.monthlyPayment,0);return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("div",{className:"flex items-center gap-4",children:(0,t.jsxs)(i.$,{variant:"ghost",size:"sm",onClick:r,children:[(0,t.jsx)(w.A,{className:"h-4 w-4 mr-2"}),"Volver a mis empresas"]})}),(0,t.jsx)(g.E,{variant:a.isActive?"default":"secondary",children:a.isActive?"Activa":"Inactiva"})]}),(0,t.jsxs)(x.Zp,{children:[(0,t.jsxs)(x.aR,{children:[(0,t.jsx)(x.ZB,{className:"text-2xl font-bold",children:a.businessName}),(0,t.jsx)("p",{className:"text-muted-foreground",children:a.tradeName})]}),(0,t.jsx)(x.Wu,{children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 pb-2",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(j.A,{className:"h-5 w-5 text-muted-foreground"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"RUC"}),(0,t.jsx)("p",{className:"font-medium",children:a.ruc})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(k.A,{className:"h-5 w-5 text-muted-foreground"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Direcci\xf3n"}),(0,t.jsx)("p",{className:"font-medium",children:a.address})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(E.A,{className:"h-5 w-5 text-muted-foreground"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Tel\xe9fono"}),(0,t.jsx)("p",{className:"font-medium",children:a.contactPhone})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(P.A,{className:"h-5 w-5 text-muted-foreground"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Email"}),(0,t.jsx)("p",{className:"font-medium",children:a.contactEmail})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(f.A,{className:"h-5 w-5 text-muted-foreground"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Persona de Contacto"}),(0,t.jsx)("p",{className:"font-medium",children:a.contactName||"N/A"})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(C.A,{className:"h-5 w-5 text-muted-foreground"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Pago mensual total"}),(0,t.jsxs)("p",{className:"font-medium",children:["S/ ",n.toLocaleString("es-PE",{minimumFractionDigits:2})]})]})]})]})})]}),(0,t.jsx)(ei,{company:a})]})};function ed(){let[e,s]=(0,r.useState)(null),[a,x]=(0,r.useState)(!1),[u,h]=(0,r.useState)({page:1,limit:6,search:void 0}),{data:g,isLoading:j}=(0,m.Rr)(u),{data:N,isLoading:f}=(0,m.P0)(e||""),v=(null==g?void 0:g.data)||[],y=null==g?void 0:g.pagination;return(0,t.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col",children:[(0,t.jsxs)("header",{className:"bg-background/60 backdrop-blur-md sticky top-0 z-50 flex h-12 shrink-0 items-center gap-2 border-b px-4",children:[(0,t.jsx)(d.SidebarTrigger,{className:"-ml-1"}),(0,t.jsx)(c.Separator,{orientation:"vertical",className:"mr-2 h-4"}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)(n.Qp,{children:(0,t.jsx)(n.AB,{children:(0,t.jsx)(n.J5,{children:(0,t.jsx)(n.tJ,{children:a?"Detalle de la Empresa":"Mis Empresas"})})})})}),(0,t.jsxs)("div",{className:"ml-auto mr-4",children:[(0,t.jsx)(l.default,{}),(0,t.jsx)(i.$,{variant:"ghost",size:"icon","aria-label":"Notificaciones",className:"mr-2",children:(0,t.jsx)(o.A,{className:"h-5 w-5"})})]})]}),(0,t.jsx)("div",{className:"flex flex-1 flex-col gap-6 p-4 md:p-6",children:a?(0,t.jsx)(ec,{company:N||null,onBack:()=>{x(!1),s(null)},isLoading:f}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p,{searchTerm:u.search||"",onSearch:e=>{h(s=>({...s,search:e.length>=2?e:void 0,page:1}))}}),(0,t.jsx)(b,{companies:v,onCompanyClick:e=>{s(e),x(!0)},isLoading:j,paginationMeta:y,onPageChange:e=>{h(s=>({...s,page:e}))},onPageSizeChange:e=>{h(s=>({...s,limit:e,page:1}))},filters:u})]})})]})}},71007:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(19946).A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},81284:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(19946).A)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},81586:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(19946).A)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},92657:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(19946).A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])}},e=>{e.O(0,[9558,5041,8859,5089,221,8034,2764,5838,7632,1339,8403,4811,8441,5964,7358],()=>e(e.s=31445)),_N_E=e.O()}]);