(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5538],{12158:(e,s,a)=>{"use strict";a.d(s,{Z:()=>d});var r=a(95155),i=a(12115),t=a(66474),l=a(47924),n=a(5196),c=a(59434);let d=(0,i.forwardRef)((e,s)=>{let{options:a=[],value:d,onValueChange:o,placeholder:m="Seleccionar...",searchPlaceholder:u="Buscar...",disabled:x,className:h,error:v,emptyMessage:p="No se encontraron opciones"}=e,[j,g]=(0,i.useState)(!1),[b,f]=(0,i.useState)(""),N=(0,i.useRef)(null),y=(0,i.useRef)(null),w=(0,i.useMemo)(()=>{if(!b)return a;let e=b.toLowerCase();return a.filter(s=>{var a;let r=s.label.toLowerCase(),i=s.value.toLowerCase(),t=r.includes(e),l=i.includes(e),n=null==(a=r.split(" - ")[0])?void 0:a.includes(e);return t||l||n})},[a,b]),S=a.find(e=>e.value===d);return(0,i.useEffect)(()=>{let e=e=>{N.current&&!N.current.contains(e.target)&&(g(!1),f(""))};return j&&(document.addEventListener("mousedown",e),setTimeout(()=>{var e;null==(e=y.current)||e.focus()},0)),()=>{document.removeEventListener("mousedown",e)}},[j]),(0,r.jsxs)("div",{className:"relative",ref:N,children:[(0,r.jsxs)("button",{ref:s,type:"button",onClick:()=>{x||(g(!j),f(""))},disabled:x,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",x&&"cursor-not-allowed opacity-50",!S&&"text-muted-foreground",v&&"border-red-500 focus:ring-red-500",h),children:[(0,r.jsx)("span",{className:"truncate",children:S?S.label:m}),(0,r.jsx)(t.A,{className:(0,c.cn)("ml-2 h-4 w-4 shrink-0 opacity-50 transition-transform",j&&"rotate-180")})]}),j&&(0,r.jsxs)("div",{className:"absolute top-full left-0 z-50 mt-1 w-full rounded-md border bg-popover shadow-md animate-in fade-in-0 zoom-in-95",children:[(0,r.jsxs)("div",{className:"flex items-center border-b px-3 py-2",children:[(0,r.jsx)(l.A,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,r.jsx)("input",{ref:y,type:"text",placeholder:u,value:b,onChange:e=>f(e.target.value),className:"flex-1 bg-transparent text-sm outline-none placeholder:text-muted-foreground"})]}),(0,r.jsx)("div",{className:"max-h-60 overflow-auto p-1",children:0===w.length?(0,r.jsx)("div",{className:"px-2 py-3 text-center text-sm text-muted-foreground",children:p}):w.map(e=>(0,r.jsxs)("button",{type:"button",onClick:()=>{var s;return!e.disabled&&(s=e.value,void(null==o||o(s),g(!1),f("")))},disabled:e.disabled,className:(0,c.cn)("flex w-full items-center rounded-sm px-2 py-2 text-sm cursor-pointer hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none",e.disabled&&"cursor-not-allowed opacity-50",d===e.value&&"bg-accent text-accent-foreground"),children:[(0,r.jsx)(n.A,{className:(0,c.cn)("mr-2 h-4 w-4",d===e.value?"opacity-100":"opacity-0")}),(0,r.jsx)("span",{className:"truncate",children:e.label})]},e.value))})]})]})});d.displayName="SearchableSelect"},36040:(e,s,a)=>{"use strict";a.d(s,{V:()=>l});var r=a(90697);class i{async getServices(e){let s=new URLSearchParams;(null==e?void 0:e.page)&&s.append("page",e.page.toString()),(null==e?void 0:e.limit)&&s.append("limit",e.limit.toString()),(null==e?void 0:e.search)&&s.append("search",e.search),(null==e?void 0:e.isActive)!==void 0&&s.append("isActive",e.isActive.toString());let a=s.toString(),i=a?"".concat(this.baseEndpoint,"?").concat(a):this.baseEndpoint;return await r.q.get(i)}async getServiceById(e){return await r.q.get("".concat(this.baseEndpoint,"/").concat(e))}async createService(e){return await r.q.post(this.baseEndpoint,e)}async updateService(e,s){return await r.q.patch("".concat(this.baseEndpoint,"/").concat(e),s)}async deleteService(e){return await r.q.delete("".concat(this.baseEndpoint,"/").concat(e))}async getDeliverablesByServiceId(e){return await r.q.get("".concat(this.baseEndpoint,"/").concat(e,"/deliverables"))}constructor(){this.baseEndpoint="/engagements"}}let t=new i,l={getServices:e=>t.getServices(e),getServiceById:e=>t.getServiceById(e),createService:e=>t.createService(e),updateService:(e,s)=>t.updateService(e,s),deleteService:e=>t.deleteService(e),getDeliverablesByServiceId:e=>t.getDeliverablesByServiceId(e)}},47262:(e,s,a)=>{"use strict";a.d(s,{S:()=>n});var r=a(95155);a(12115);var i=a(34848),t=a(5196),l=a(59434);function n(e){let{className:s,...a}=e;return(0,r.jsx)(i.bL,{"data-slot":"checkbox",className:(0,l.cn)("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",s),...a,children:(0,r.jsx)(i.C1,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:(0,r.jsx)(t.A,{className:"size-3.5"})})})}},58246:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>ea});var r=a(95155),i=a(91165),t=a(19018),l=a(30285),n=a(22346),c=a(3501),d=a(23861),o=a(12115),m=a(84616),u=a(88889),x=a(26126),h=a(21492),v=a(92657),p=a(13717),j=a(62525);let g=e=>e?"default":"secondary",b=e=>e?"Activo":"Inactivo",f=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return e.length<=s?e:e.substring(0,s)+"..."};var N=a(62523),y=a(59409),w=a(66695),S=a(47924),C=a(54416);let A=e=>{let{filters:s,services:a,onFiltersChange:i,onClearFilters:t}=e,n=s.search||s.serviceId||s.isActive;return(0,r.jsx)(w.Zp,{children:(0,r.jsx)(w.Wu,{children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(S.A,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,r.jsx)(N.p,{placeholder:"Buscar por nombre o descripci\xf3n.",value:s.search,onChange:e=>{i({search:e.target.value,page:1})},className:"pl-10"})]})}),(0,r.jsx)("div",{children:(0,r.jsxs)(y.l6,{value:s.serviceId||"all",onValueChange:e=>{i({serviceId:"all"===e?"":e,page:1})},children:[(0,r.jsx)(y.bq,{children:(0,r.jsx)(y.yv,{placeholder:"Todos los servicios"})}),(0,r.jsxs)(y.gC,{children:[(0,r.jsx)(y.eb,{value:"all",children:"Todos los servicios"}),a.map(e=>(0,r.jsx)(y.eb,{value:e.id,children:e.name},e.id))]})]})}),(0,r.jsx)("div",{children:(0,r.jsxs)(y.l6,{value:s.isActive||"all",onValueChange:e=>{i({isActive:"all"===e?"":e,page:1})},children:[(0,r.jsx)(y.bq,{children:(0,r.jsx)(y.yv,{placeholder:"Todos los estados"})}),(0,r.jsxs)(y.gC,{children:[(0,r.jsx)(y.eb,{value:"all",children:"Todos los estados"}),(0,r.jsx)(y.eb,{value:"true",children:"Activos"}),(0,r.jsx)(y.eb,{value:"false",children:"Inactivos"})]})]})}),(0,r.jsx)("div",{children:(0,r.jsxs)(l.$,{variant:"outline",onClick:()=>{t?t():i({search:"",serviceId:"",isActive:"",page:1})},disabled:!n,className:"w-full",children:[(0,r.jsx)(C.A,{className:"h-4 w-4 mr-2"}),"Limpiar Filtros"]})})]})})})};var E=a(62177),k=a(90221),I=a(73162),q=a(54165),D=a(17759),z=a(88539),B=a(47262),M=a(12158),P=a(95838),R=a(26715),K=a(5041),L=a(56671),$=a(90697);class V{async getAll(e){let s=new URLSearchParams;(null==e?void 0:e.search)&&s.append("search",e.search),(null==e?void 0:e.serviceId)&&s.append("serviceId",e.serviceId),(null==e?void 0:e.isActive)!==void 0&&s.append("isActive",e.isActive.toString()),(null==e?void 0:e.page)&&s.append("page",e.page.toString()),(null==e?void 0:e.limit)&&s.append("limit",e.limit.toString());let a=s.toString(),r=a?"".concat(this.baseEndpoint,"?").concat(a):this.baseEndpoint;return await $.q.get(r)}async getById(e){return await $.q.get("".concat(this.baseEndpoint,"/").concat(e))}async create(e){return await $.q.post(this.baseEndpoint,e)}async update(e,s){return await $.q.patch("".concat(this.baseEndpoint,"/").concat(e),s)}async delete(e){return await $.q.delete("".concat(this.baseEndpoint,"/").concat(e))}constructor(){this.baseEndpoint="/deliverables"}}let F=new V;var Q=a(36040);let O={all:["deliverables"],lists:()=>[...O.all,"list"],list:e=>[...O.lists(),e],details:()=>[...O.all,"detail"],detail:e=>[...O.details(),e]},T=()=>(0,P.useQuery)({queryKey:["all-services-for-select"],queryFn:()=>Q.V.getServices({limit:100}),staleTime:6e5,select:e=>e.data.map(e=>({value:e.id,label:"".concat(e.name),disabled:!e.isActive}))}),J=I.Ik({serviceId:I.Yj().min(1,"El servicio es requerido"),name:I.Yj().min(1,"El nombre es requerido"),description:I.Yj().min(1,"La descripci\xf3n es requerida"),isActive:I.zM()}),G=e=>{let{open:s,onOpenChange:a}=e,[i,t]=(0,o.useState)(!1),n=(()=>{let e=(0,R.useQueryClient)();return(0,K.useMutation)({mutationFn:e=>F.create(e),onSuccess:s=>{L.oR.success(s.message||"El entregable se ha creado correctamente"),e.invalidateQueries({queryKey:O.lists()}),e.invalidateQueries({predicate:e=>"engagements"===e.queryKey[0]&&"deliverables"===e.queryKey[1]})},onError:e=>{var s,a;L.oR.error((null==(a=e.response)||null==(s=a.data)?void 0:s.message)||"Ha ocurrido un error inesperado")}})})(),{data:c=[],isLoading:d}=T(),m=(0,E.mN)({resolver:(0,k.u)(J),defaultValues:{serviceId:"",name:"",description:"",isActive:!0}}),u=async e=>{try{t(!0),await n.mutateAsync(e),m.reset(),a(!1)}catch(e){console.error("Error creating deliverable:",e)}finally{t(!1)}},x=()=>{m.reset(),a(!1)};return(0,r.jsx)(q.lG,{open:s,onOpenChange:x,children:(0,r.jsxs)(q.Cf,{className:"sm:max-w-[600px] max-w-[95vw] max-h-[90vh] overflow-y-auto",onPointerDownOutside:e=>e.preventDefault(),onEscapeKeyDown:e=>e.preventDefault(),children:[(0,r.jsxs)(q.c7,{className:"border-b pb-4",children:[(0,r.jsx)(q.L3,{children:"Crear Nuevo Entregable"}),(0,r.jsx)(q.rr,{children:"Completa la informaci\xf3n para crear un nuevo entregable asociado a un servicio."})]}),(0,r.jsx)(D.lV,{...m,children:(0,r.jsxs)("form",{onSubmit:m.handleSubmit(u),className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium",children:"Informaci\xf3n del Entregable"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,r.jsx)(D.zB,{control:m.control,name:"serviceId",render:e=>{let{field:s}=e;return(0,r.jsxs)(D.eI,{children:[(0,r.jsx)(D.lR,{children:"Servicio *"}),(0,r.jsx)(D.MJ,{children:(0,r.jsx)(M.Z,{options:c,value:s.value,onValueChange:s.onChange,placeholder:"Selecciona un servicio",searchPlaceholder:"Buscar servicio...",emptyMessage:"No se encontraron servicios",disabled:d})}),(0,r.jsx)(D.C5,{})]})}}),(0,r.jsx)(D.zB,{control:m.control,name:"name",render:e=>{let{field:s}=e;return(0,r.jsxs)(D.eI,{children:[(0,r.jsx)(D.lR,{children:"Nombre *"}),(0,r.jsx)(D.MJ,{children:(0,r.jsx)(N.p,{placeholder:"Ej: Marco Te\xf3rico, Cap\xedtulo I, etc.",...s})}),(0,r.jsx)(D.C5,{})]})}}),(0,r.jsx)(D.zB,{control:m.control,name:"description",render:e=>{let{field:s}=e;return(0,r.jsxs)(D.eI,{children:[(0,r.jsx)(D.lR,{children:"Descripci\xf3n *"}),(0,r.jsx)(D.MJ,{children:(0,r.jsx)(z.T,{placeholder:"Describe el entregable...",className:"min-h-[100px]",...s})}),(0,r.jsx)(D.C5,{})]})}}),(0,r.jsx)(D.zB,{control:m.control,name:"isActive",render:e=>{let{field:s}=e;return(0,r.jsxs)(D.eI,{className:"flex flex-row items-center space-x-3 space-y-0",children:[(0,r.jsx)(D.MJ,{children:(0,r.jsx)(B.S,{checked:s.value,onCheckedChange:s.onChange})}),(0,r.jsxs)("div",{className:"space-y-1 leading-none",children:[(0,r.jsx)(D.lR,{children:"Entregable activo"}),(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"El entregable estar\xe1 disponible para su uso"})]})]})}})]})]}),(0,r.jsxs)(q.Es,{className:"gap-2 border-t pt-4",children:[(0,r.jsx)(l.$,{type:"button",variant:"outline",onClick:x,disabled:i,className:"w-full sm:w-auto",children:"Cancelar"}),(0,r.jsx)(l.$,{type:"submit",disabled:i||d,className:"w-full sm:w-auto",children:i?"Creando...":"Crear Entregable"})]})]})})]})})},Z=I.Ik({serviceId:I.Yj().min(1,"El servicio es requerido"),name:I.Yj().min(1,"El nombre es requerido"),description:I.Yj().min(1,"La descripci\xf3n es requerida"),isActive:I.zM()}),Y=e=>{let{deliverable:s,open:a,onOpenChange:i}=e,[t,n]=(0,o.useState)(!1),c=(()=>{let e=(0,R.useQueryClient)();return(0,K.useMutation)({mutationFn:e=>{let{id:s,data:a}=e;return F.update(s,a)},onSuccess:(s,a)=>{let{id:r}=a;L.oR.success(s.message||"El entregable se ha actualizado correctamente"),e.invalidateQueries({queryKey:O.lists()}),e.invalidateQueries({queryKey:O.detail(r)}),e.invalidateQueries({predicate:e=>"engagements"===e.queryKey[0]&&"deliverables"===e.queryKey[1]})},onError:e=>{var s,a;L.oR.error((null==(a=e.response)||null==(s=a.data)?void 0:s.message)||"Ha ocurrido un error inesperado")}})})(),{data:d=[],isLoading:m}=T(),u=(0,E.mN)({resolver:(0,k.u)(Z),defaultValues:{serviceId:s.serviceId,name:s.name,description:s.description,isActive:s.isActive}});(0,o.useEffect)(()=>{s&&u.reset({serviceId:s.serviceId,name:s.name,description:s.description,isActive:s.isActive})},[s,u]);let x=async e=>{try{n(!0),await c.mutateAsync({id:s.id,data:e}),i(!1)}catch(e){console.error("Error updating deliverable:",e)}finally{n(!1)}},h=()=>{u.reset(),i(!1)};return(0,r.jsx)(q.lG,{open:a,onOpenChange:h,children:(0,r.jsxs)(q.Cf,{className:"sm:max-w-[600px] max-w-[95vw] max-h-[90vh] overflow-y-auto",onPointerDownOutside:e=>e.preventDefault(),onEscapeKeyDown:e=>e.preventDefault(),children:[(0,r.jsxs)(q.c7,{children:[(0,r.jsx)(q.L3,{children:"Editar Entregable"}),(0,r.jsxs)(q.rr,{children:['Modifica la informaci\xf3n del entregable "',s.name,'".']})]}),(0,r.jsx)(D.lV,{...u,children:(0,r.jsxs)("form",{onSubmit:u.handleSubmit(x),className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-muted-foreground",children:"Informaci\xf3n b\xe1sica"}),(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-1",children:[(0,r.jsx)(D.zB,{control:u.control,name:"serviceId",render:e=>{let{field:s}=e;return(0,r.jsxs)(D.eI,{children:[(0,r.jsx)(D.lR,{children:"Servicio *"}),(0,r.jsx)(D.MJ,{children:(0,r.jsx)(M.Z,{options:d,value:s.value,onValueChange:s.onChange,placeholder:"Selecciona un servicio",searchPlaceholder:"Buscar servicio...",emptyMessage:"No se encontraron servicios",disabled:m})}),(0,r.jsx)(D.C5,{})]})}}),(0,r.jsx)(D.zB,{control:u.control,name:"name",render:e=>{let{field:s}=e;return(0,r.jsxs)(D.eI,{children:[(0,r.jsx)(D.lR,{children:"Nombre *"}),(0,r.jsx)(D.MJ,{children:(0,r.jsx)(N.p,{placeholder:"Nombre del entregable",...s})}),(0,r.jsx)(D.C5,{})]})}})]}),(0,r.jsx)(D.zB,{control:u.control,name:"description",render:e=>{let{field:s}=e;return(0,r.jsxs)(D.eI,{children:[(0,r.jsx)(D.lR,{children:"Descripci\xf3n *"}),(0,r.jsx)(D.MJ,{children:(0,r.jsx)(z.T,{placeholder:"Descripci\xf3n del entregable...",className:"min-h-[100px]",...s})}),(0,r.jsx)(D.C5,{})]})}})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-muted-foreground",children:"Estado"}),(0,r.jsx)(D.zB,{control:u.control,name:"isActive",render:e=>{let{field:s}=e;return(0,r.jsxs)(D.eI,{className:"flex flex-row items-center space-x-3",children:[(0,r.jsx)(D.MJ,{children:(0,r.jsx)(B.S,{checked:s.value,onCheckedChange:s.onChange})}),(0,r.jsxs)("div",{className:"space-y-1 leading-none",children:[(0,r.jsx)(D.lR,{children:"Entregable activo"}),(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"El entregable estar\xe1 disponible para su uso"})]})]})}})]})]})}),(0,r.jsxs)(q.Es,{className:"mt-6",children:[(0,r.jsx)(l.$,{type:"button",variant:"outline",onClick:h,disabled:t,className:"w-full sm:w-auto",children:"Cancelar"}),(0,r.jsx)(l.$,{type:"submit",disabled:t||m,className:"w-full sm:w-auto",onClick:u.handleSubmit(x),children:t?"Guardando...":"Guardar Cambios"})]})]})})};var _=a(37108),W=a(43453),H=a(54861);let U=e=>{let{deliverable:s,open:a,onOpenChange:i}=e;return(0,r.jsx)(q.lG,{open:a,onOpenChange:i,children:(0,r.jsxs)(q.Cf,{className:"sm:max-w-[600px] max-h-[90vh] flex flex-col p-0",children:[(0,r.jsxs)(q.c7,{className:"px-6 pt-6 pb-4 flex-shrink-0",children:[(0,r.jsxs)(q.L3,{className:"flex items-center space-x-2",children:[(0,r.jsx)(_.A,{className:"h-5 w-5"}),(0,r.jsx)("span",{children:"Detalles del Entregable"})]}),(0,r.jsxs)(q.rr,{children:['Informaci\xf3n completa del entregable "',s.name,'"']})]}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto px-6 pb-6",children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)(w.Zp,{children:[(0,r.jsx)(w.aR,{children:(0,r.jsx)(w.ZB,{className:"text-lg",children:"Informaci\xf3n General"})}),(0,r.jsxs)(w.Wu,{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Nombre"}),(0,r.jsx)("p",{className:"text-base font-medium break-words",children:s.name})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Descripci\xf3n"}),(0,r.jsx)("p",{className:"text-base break-words",children:s.description})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2 flex-wrap",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Estado:"}),(0,r.jsxs)(x.E,{variant:g(s.isActive),children:[s.isActive?(0,r.jsx)(W.A,{className:"h-3 w-3 mr-1"}):(0,r.jsx)(H.A,{className:"h-3 w-3 mr-1"}),b(s.isActive)]})]})]})]}),s.service&&(0,r.jsxs)(w.Zp,{children:[(0,r.jsx)(w.aR,{children:(0,r.jsx)(w.ZB,{className:"text-lg",children:"Servicio Asociado"})}),(0,r.jsxs)(w.Wu,{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Nombre del Servicio"}),(0,r.jsx)("p",{className:"text-base font-medium break-words",children:s.service.name})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Descripci\xf3n del Servicio"}),(0,r.jsx)("p",{className:"text-base break-words",children:s.service.description})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2 flex-wrap",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Estado del Servicio:"}),(0,r.jsxs)(x.E,{variant:g(s.service.isActive),children:[s.service.isActive?(0,r.jsx)(W.A,{className:"h-3 w-3 mr-1"}):(0,r.jsx)(H.A,{className:"h-3 w-3 mr-1"}),b(s.service.isActive)]})]})]})]})]})})]})})};var X=a(1243);let ee=e=>{let{deliverable:s,open:a,onOpenChange:i}=e,[t,n]=(0,o.useState)(!1),c=(()=>{let e=(0,R.useQueryClient)();return(0,K.useMutation)({mutationFn:e=>F.delete(e),onSuccess:s=>{L.oR.success(s.message||"El entregable se ha eliminado correctamente"),e.invalidateQueries({queryKey:O.lists()}),e.invalidateQueries({predicate:e=>"engagements"===e.queryKey[0]&&"deliverables"===e.queryKey[1]})},onError:e=>{var s,a;L.oR.error((null==(a=e.response)||null==(s=a.data)?void 0:s.message)||"Ha ocurrido un error inesperado")}})})(),d=async()=>{try{n(!0),await c.mutateAsync(s.id),i(!1)}catch(e){console.error("Error deleting deliverable:",e)}finally{n(!1)}};return(0,r.jsx)(q.lG,{open:a,onOpenChange:i,children:(0,r.jsxs)(q.Cf,{className:"sm:max-w-[500px] max-h-[90vh] flex flex-col p-0",children:[(0,r.jsxs)(q.c7,{className:"px-6 pt-6 pb-4 flex-shrink-0",children:[(0,r.jsxs)(q.L3,{className:"flex items-center space-x-2 text-destructive",children:[(0,r.jsx)(X.A,{className:"h-5 w-5"}),(0,r.jsx)("span",{children:"Confirmar Eliminaci\xf3n"})]}),(0,r.jsx)(q.rr,{children:"Esta acci\xf3n no se puede deshacer. Se eliminar\xe1 permanentemente el entregable."})]}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto px-6",children:(0,r.jsxs)("div",{className:"space-y-4 pb-4",children:[(0,r.jsxs)("div",{className:"rounded-lg border p-4 bg-muted/50",children:[(0,r.jsx)("h4",{className:"font-medium mb-2",children:"Entregable a eliminar:"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-sm font-medium",children:"Nombre: "}),(0,r.jsx)("span",{className:"text-sm break-words",children:s.name})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-sm font-medium",children:"Descripci\xf3n: "}),(0,r.jsx)("span",{className:"text-sm break-words",children:s.description})]}),s.service&&(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-sm font-medium",children:"Servicio: "}),(0,r.jsx)("span",{className:"text-sm break-words",children:s.service.name})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2 flex-wrap",children:[(0,r.jsx)("span",{className:"text-sm font-medium",children:"Estado: "}),(0,r.jsx)(x.E,{variant:g(s.isActive),className:"text-xs",children:b(s.isActive)})]})]})]}),(0,r.jsx)("div",{className:"rounded-lg border border-destructive/20 bg-destructive/10 p-4",children:(0,r.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,r.jsx)(X.A,{className:"h-4 w-4 text-destructive mt-0.5 flex-shrink-0"}),(0,r.jsxs)("div",{className:"text-sm min-w-0",children:[(0,r.jsx)("p",{className:"font-medium text-destructive mb-1",children:"Advertencia"}),(0,r.jsx)("p",{className:"text-destructive/80",children:"Al eliminar este entregable:"}),(0,r.jsxs)("ul",{className:"list-disc list-inside mt-2 text-destructive/80 space-y-1",children:[(0,r.jsx)("li",{children:"Se perder\xe1 toda la informaci\xf3n asociada"}),(0,r.jsx)("li",{children:"No podr\xe1 ser recuperado posteriormente"}),(0,r.jsx)("li",{children:"Puede afectar contratos que lo incluyan"})]})]})]})})]})}),(0,r.jsx)(q.Es,{className:"px-6 pb-6 pt-4 flex-shrink-0 border-t bg-background/95",children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto sm:space-x-2",children:[(0,r.jsx)(l.$,{variant:"outline",onClick:()=>i(!1),disabled:t,className:"w-full sm:w-auto order-2 sm:order-1",children:"Cancelar"}),(0,r.jsx)(l.$,{variant:"destructive",onClick:d,disabled:t,className:"w-full sm:w-auto min-w-[100px] order-1 sm:order-2",children:t?"Eliminando...":(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(j.A,{className:"h-4 w-4 mr-2"}),"Eliminar"]})})]})})]})})},es=()=>{let[e,s]=(0,o.useState)({search:"",serviceId:"",isActive:"",page:1,limit:10}),[a,i]=(0,o.useState)(null),[t,n]=(0,o.useState)(!1),[c,d]=(0,o.useState)(!1),[N,y]=(0,o.useState)(!1),[w,S]=(0,o.useState)(!1),{data:C,isLoading:E}=(e=>(0,P.useQuery)({queryKey:O.list(e),queryFn:()=>F.getAll(e),refetchOnWindowFocus:!0,staleTime:0}))({search:e.search||void 0,serviceId:e.serviceId||void 0,isActive:""===e.isActive?void 0:"true"===e.isActive,page:e.page,limit:e.limit}),{data:k}=(0,P.useQuery)({queryKey:["services-for-select"],queryFn:()=>Q.V.getServices({isActive:!0}),staleTime:6e5}),I=(null==C?void 0:C.data)||[],q=(null==k?void 0:k.data)||[],D=null==C?void 0:C.meta,z=e=>{i(e),y(!0)},B=e=>{i(e),d(!0)},M=e=>{i(e),S(!0)},R=(0,o.useMemo)(()=>(e=>{let{onView:s,onEdit:a,onDelete:i}=e;return[{accessorKey:"name",header:e=>{let{column:s}=e;return(0,r.jsxs)(l.$,{variant:"ghost",onClick:()=>s.toggleSorting("asc"===s.getIsSorted()),className:"h-8 p-0 font-semibold",children:["Nombre",(0,r.jsx)(h.A,{className:"ml-2 h-4 w-4"})]})},cell:e=>{let{row:s}=e,a=s.original;return(0,r.jsxs)("div",{className:"max-w-[300px]",children:[(0,r.jsx)("div",{className:"font-medium",children:a.name}),(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:f(a.description,60)})]})}},{accessorKey:"service",header:"Servicio",cell:e=>{var s;let{row:a}=e,i=a.original.service;return(0,r.jsx)("div",{className:"max-w-[200px]",children:i?(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium",children:i.name}),(0,r.jsxs)("div",{className:"text-sm text-muted-foreground",children:["$",null==(s=i.basePrice)?void 0:s.toFixed(2)]})]}):(0,r.jsx)("span",{className:"text-muted-foreground",children:"Sin servicio"})})}},{accessorKey:"isActive",header:e=>{let{column:s}=e;return(0,r.jsxs)(l.$,{variant:"ghost",onClick:()=>s.toggleSorting("asc"===s.getIsSorted()),className:"h-8 p-0 font-semibold",children:["Estado",(0,r.jsx)(h.A,{className:"ml-2 h-4 w-4"})]})},cell:e=>{let{row:s}=e,a=s.getValue("isActive");return(0,r.jsx)(x.E,{variant:g(a),children:b(a)})}},{accessorKey:"createdAt",header:e=>{let{column:s}=e;return(0,r.jsxs)(l.$,{variant:"ghost",onClick:()=>s.toggleSorting("asc"===s.getIsSorted()),className:"h-8 p-0 font-semibold",children:["Fecha de Creaci\xf3n",(0,r.jsx)(h.A,{className:"ml-2 h-4 w-4"})]})},cell:e=>{let{row:s}=e,a=s.getValue("createdAt");return(0,r.jsx)("div",{className:"text-sm",children:new Date(a).toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit"})})}},{id:"actions",header:"Acciones",cell:e=>{let{row:t}=e,n=t.original;return(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)(l.$,{variant:"outline",size:"sm",className:"h-8 w-8",onClick:()=>s(n),title:"Ver detalles",children:(0,r.jsx)(v.A,{className:"h-4 w-4"})}),(0,r.jsx)(l.$,{variant:"outline",size:"sm",className:"h-8 w-8",onClick:()=>a(n),title:"Editar",children:(0,r.jsx)(p.A,{className:"h-4 w-4"})}),(0,r.jsx)(l.$,{variant:"outline",size:"sm",className:"h-8 w-8 text-destructive hover:text-destructive",onClick:()=>i(n),title:"Eliminar",children:(0,r.jsx)(j.A,{className:"h-4 w-4"})})]})}}]})({onView:z,onEdit:B,onDelete:M}),[]),K=D?{total:D.total,page:D.page,limit:D.limit,totalPages:D.totalPages||D.lastPage,hasNext:void 0!==D.hasNext?D.hasNext:D.page<(D.totalPages||D.lastPage),hasPrevious:void 0!==D.hasPrevious?D.hasPrevious:D.page>1}:void 0;return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Entregables"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Gestiona los entregables asociados a los servicios de consultor\xeda"})]}),(0,r.jsxs)(l.$,{onClick:()=>n(!0),className:"w-full sm:w-auto",children:[(0,r.jsx)(m.A,{className:"mr-2 h-4 w-4"}),"Crear Entregable"]})]}),(0,r.jsx)(A,{filters:e,services:q,onFiltersChange:e=>{s(s=>({...s,...e,page:1}))},onClearFilters:()=>{s({search:"",serviceId:"",isActive:"",page:1,limit:10})}}),(0,r.jsx)(u.b,{data:I,columns:R,isLoading:E,noDataMessage:"No se encontraron entregables",enablePagination:!0,enableSorting:!0,pageSize:e.limit,serverPagination:!0,paginationMeta:K,onPageChange:e=>{s(s=>({...s,page:e}))},onPageSizeChange:e=>{s(s=>({...s,limit:e,page:1}))}}),(0,r.jsx)(G,{open:t,onOpenChange:e=>{n(e)}}),a&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Y,{deliverable:a,open:c,onOpenChange:e=>{d(e),e||i(null)}}),(0,r.jsx)(U,{deliverable:a,open:N,onOpenChange:e=>{y(e),e||i(null)}}),(0,r.jsx)(ee,{deliverable:a,open:w,onOpenChange:e=>{S(e),e||i(null)}})]})]})};function ea(){return(0,r.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col",children:[(0,r.jsxs)("header",{className:"bg-background/60 backdrop-blur-md sticky top-0 z-50 flex h-12 shrink-0 items-center gap-2 border-b px-4",children:[(0,r.jsx)(c.SidebarTrigger,{className:"-ml-1"}),(0,r.jsx)(n.Separator,{orientation:"vertical",className:"mr-2 h-4"}),(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsx)(t.Qp,{children:(0,r.jsx)(t.AB,{children:(0,r.jsx)(t.J5,{children:(0,r.jsx)(t.tJ,{children:"Gesti\xf3n de Entregables"})})})})}),(0,r.jsxs)("div",{className:"ml-auto mr-4",children:[(0,r.jsx)(i.default,{}),(0,r.jsx)(l.$,{variant:"ghost",size:"icon","aria-label":"Notificaciones",className:"mr-2",children:(0,r.jsx)(d.A,{className:"h-5 w-5"})})]})]}),(0,r.jsx)("div",{className:"flex flex-1 flex-col gap-6 p-4 md:p-6",children:(0,r.jsx)(es,{})})]})}},76303:(e,s,a)=>{Promise.resolve().then(a.bind(a,58246))},88539:(e,s,a)=>{"use strict";a.d(s,{T:()=>t});var r=a(95155);a(12115);var i=a(59434);function t(e){let{className:s,...a}=e;return(0,r.jsx)("textarea",{className:(0,i.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-xs placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),...a})}}},e=>{e.O(0,[9558,5041,8859,5089,221,8034,2764,5838,2896,3154,1339,8403,8889,8441,5964,7358],()=>e(e.s=76303)),_N_E=e.O()}]);