"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9094],{5475:(e,r,a)=>{a.d(r,{KG:()=>s,Pi:()=>i,_J:()=>t,gG:()=>o});var s=function(e){return e.DNI="DNI",e.PASSPORT="PASSPORT",e.CE="CE",e}({}),t=function(e){return e.BACHILLER="Bachiller",e.LICENCIADO="Licenciado",e.MAGISTER="Magister",e.DOCTOR="Doctor",e}({}),o=function(e){return e.SUPER_ADMIN="SUPER_ADMIN",e.ADMIN="ADMIN",e.COLLABORATOR_INTERNAL="COLLABORATOR_INTERNAL",e.COLLABORATOR_EXTERNAL="COLLABORATOR_EXTERNAL",e.RRHH="RRHH",e}({});let i=e=>"RRHH"===e||"COLLABORATOR_INTERNAL"===e},29090:(e,r,a)=>{a.d(r,{y:()=>o});var s=a(90697),t=a(49509);console.log("API URL:",t.env.NEXT_PUBLIC_API_CECAGEM_URL);let o={login:async e=>{let r=await fetch("".concat(t.env.NEXT_PUBLIC_API_CECAGEM_URL,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),a=await r.json();return console.log("Login result:",a),a},me:async()=>{let e=await s.q.get("/auth/me");return console.log("Me result:",e),e},logout:async()=>{try{await s.q.post("/auth/logout")}catch(e){console.error("Logout error:",e)}}}},29094:(e,r,a)=>{a.d(r,{H9:()=>s.AuthInitializer,y1:()=>n.y,X5:()=>d,As:()=>t.useAuth,nc:()=>c,vz:()=>o.useLogin,Wn:()=>i.useLogout});var s=a(65526);a(64292);var t=a(54331),o=a(75806),i=a(75431),n=a(29090);a(85674);let c=(0,a(65453).v)(e=>({user:null,isAuthenticated:!1,hydrated:!1,setSession:r=>e(()=>({user:r,isAuthenticated:!0})),clearSession:()=>e(()=>({user:null,isAuthenticated:!1})),markHydrated:()=>e({hydrated:!0}),resetHydration:()=>e({hydrated:!1})}));var l=a(73162);let d=l.Ik({email:l.Rp("Por favor ingresa una direcci\xf3n de correo electr\xf3nsico v\xe1lida"),password:l.Yj().min(1,"La contrase\xf1a es requerida").min(2,"La contrase\xf1a debe tener al menos 2 caracteres"),rememberMe:l.zM().optional()});l.Ik({email:l.Rp("Por favor ingresa una direcci\xf3n de correo electr\xf3nico v\xe1lida")}),l.Ik({password:l.Yj().min(1,"Password is required").min(6,"Password must be at least 6 characters long"),confirmPassword:l.Yj().min(1,"Please confirm your password")}).refine(e=>e.password===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]})},47262:(e,r,a)=>{a.d(r,{S:()=>n});var s=a(95155);a(12115);var t=a(34848),o=a(5196),i=a(59434);function n(e){let{className:r,...a}=e;return(0,s.jsx)(t.bL,{"data-slot":"checkbox",className:(0,i.cn)("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",r),...a,children:(0,s.jsx)(t.C1,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:(0,s.jsx)(o.A,{className:"size-3.5"})})})}},54331:(e,r,a)=>{a.r(r),a.d(r,{useAuth:()=>i});var s=a(12115),t=a(35695),o=a(29094);let i=()=>{let e=(0,t.usePathname)(),{setSession:r,clearSession:a,markHydrated:i,hydrated:n,isAuthenticated:c}=(0,o.nc)();return(0,s.useEffect)(()=>{if(n||"/login"===e){n||i();return}(async()=>{try{let e=await o.y1.me();r(e)}catch(e){console.log(" Validaci\xf3n de sesi\xf3n fall\xf3 desde useAuth:",e),a()}finally{i()}})()},[n,r,a,i,e]),{isAuthenticated:c,hydrated:n}}},64292:(e,r,a)=>{a.r(r),a.d(r,{LoginForm:()=>y});var s=a(95155),t=a(12115),o=a(66766),i=a(90221),n=a(59434),c=a(62177),l=a(91165),d=a(30285),u=a(66695),m=a(62523),h=a(85057),p=a(85339),g=a(78749),x=a(92657),f=a(47262),v=a(29094);function y(e){let{className:r,...a}=e,[y,w]=(0,t.useState)(!1),N=(0,t.useId)(),j=(0,t.useId)(),A=(0,v.vz)(),{register:R,handleSubmit:E,control:C,setValue:k,formState:{errors:L}}=(0,c.mN)({resolver:(0,i.u)(v.X5)}),I=async e=>{A.mutate({email:e.email,password:e.password},{onSuccess:()=>{}})},P=function(e){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];k("email",e.email,{shouldValidate:!0}),k("password",e.password,{shouldValidate:!0}),r&&E(I)()};return(0,s.jsxs)("div",{className:(0,n.cn)("flex flex-col gap-6",r),...a,children:[(0,s.jsxs)(u.Zp,{className:"overflow-hidden p-0 drop-blur-md backdrop-blur-xl",children:[(0,s.jsx)("div",{className:"absolute top-4 right-4 z-10",children:(0,s.jsx)(l.default,{})}),(0,s.jsxs)(u.Wu,{className:"grid p-0 md:grid-cols-2",children:[(0,s.jsx)("form",{onSubmit:E(I),className:"p-6 md:p-8",children:(0,s.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,s.jsxs)("div",{className:"flex justify-center mb-4 md:hidden",children:[(0,s.jsx)(o.default,{src:"/image/logos/logocecagem.png",alt:"CECAGEM logo",width:180,height:180,className:"block dark:hidden"}),(0,s.jsx)(o.default,{src:"/image/logos/logoblanco.png",alt:"CECAGEM logo",width:180,height:180,className:"hidden dark:block"})]}),(0,s.jsx)("h1",{className:" text-2xl font-bold",children:"Inicia sesi\xf3n"}),(0,s.jsx)("p",{className:"text-muted-foreground text-balance",children:"Accede a tu plataforma de consultor\xeda de tesis"})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("div",{className:"group relative",children:[(0,s.jsx)(b,{htmlFor:N,label:"Correo electr\xf3nico"}),(0,s.jsx)(m.p,{id:N,type:"email",placeholder:" ",autoFocus:!0,...R("email"),className:"!bg-card h-11 ".concat(L.email?"border-destructive focus-visible:ring-2 focus-visible:ring-destructive/50 focus-visible:border-destructive":"")})]}),L.email&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-destructive",children:[(0,s.jsx)(p.A,{className:"h-4 w-4"}),L.email.message]})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("div",{className:"group relative",children:[(0,s.jsx)(b,{htmlFor:j,label:"Contrase\xf1a"}),(0,s.jsx)(m.p,{id:j,type:y?"text":"password",placeholder:" ",...R("password"),className:"!bg-card h-11 ".concat(L.password?"border-destructive focus-visible:ring-2 focus-visible:ring-destructive/50 focus-visible:border-destructive pr-10":"pr-10")}),(0,s.jsx)(d.$,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>w(!y),children:y?(0,s.jsx)(g.A,{className:"h-4 w-4"}):(0,s.jsx)(x.A,{className:"h-4 w-4"})})]}),L.password&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-destructive",children:[(0,s.jsx)(p.A,{className:"h-4 w-4"}),L.password.message]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(c.xI,{name:"rememberMe",control:C,render:e=>{let{field:r}=e;return(0,s.jsx)(f.S,{id:"rememberMe",checked:r.value,onCheckedChange:e=>r.onChange(!0===e)})}}),(0,s.jsx)(h.J,{htmlFor:"rememberMe",className:"text-sm",children:"Recu\xe9rdame"}),(0,s.jsx)("a",{href:"#",className:"ml-auto text-sm underline-offset-2 hover:underline",children:"\xbfOlvidaste tu contrase\xf1a?"})]}),(0,s.jsx)(d.$,{type:"submit",disabled:A.isPending,className:"w-full bg-gradient-to-r from-primary to-secondary dark:from-primary/80 dark:to-secondary/80 text-white",children:A.isPending?"Iniciando sesi\xf3n...":"Iniciar sesi\xf3n"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries({super_admin:{name:"super_admin",email:"super_admin@ejemplo.com",password:"123456"},admin:{name:"admin",email:"admin@cecagem.com",password:"123456"},rrhh:{name:"rrhh",email:"rrhh@cecagem.com",password:"123456"},colaborador_interno:{name:"colaborador_interno",email:"carlos.mendoza@cecagem.com",password:"123456"},colaborador_externo:{name:"colaborador_externo",email:"diana.torres@freelance.com",password:"123456"}}).map(e=>{let[r,a]=e;return(0,s.jsx)(d.$,{variant:"outline",onClick:()=>P(a),className:"capitalize ",children:a.name.replace("_"," ")},r)})}),(0,s.jsxs)("div",{className:"text-center text-sm text-muted-foreground",children:["\xbfTienes problemas para iniciar sesi\xf3n?"," ",(0,s.jsx)("a",{href:"#",className:"underline underline-offset-4 dark:hover:text-white",children:"Contacta soporte t\xe9cnico"}),"."]})]})}),(0,s.jsx)("div",{className:"bg-gradient-to-l from-primary/20 to-secondary/20 dark:from-primary/60 dark:to-secondary/60 relative hidden md:flex md:flex-col md:items-center md:justify-center p-8",children:(0,s.jsxs)("div",{className:"text-center space-y-6",children:[(0,s.jsxs)("div",{className:"mx-auto flex items-center justify-center",children:[(0,s.jsx)(o.default,{src:"/image/logos/logocecagem.png",alt:"CECAGEM logo",width:180,height:180,className:"block dark:hidden"}),(0,s.jsx)(o.default,{src:"/image/logos/logoblanco.png",alt:"CECAGEM logo",width:180,height:180,className:"hidden dark:block"})]}),(0,s.jsx)("div",{className:"space-y-3",children:(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-300 text-sm leading-relaxed max-w-xs",children:"Plataforma de consultor\xeda acad\xe9mica y apoyo en proyectos de investigaci\xf3n."})})]})})]})]}),(0,s.jsxs)("div",{className:"text-muted-foreground text-center text-xs text-balance",children:["Al hacer clic en continuar, aceptas nuestros"," ",(0,s.jsx)("a",{href:"#",className:"underline underline-offset-4 hover:text-primary dark:hover:text-white",children:"T\xe9rminos de Servicio"})," ","y"," ",(0,s.jsx)("a",{href:"#",className:"underline underline-offset-4 hover:text-primary dark:hover:text-white",children:"Pol\xedtica de Privacidad"}),". CECAGEM - Consultor\xeda especializada en tesis y proyectos acad\xe9micos."]})]})}function b(e){let{htmlFor:r,label:a}=e;return(0,s.jsx)("label",{htmlFor:r,className:"origin-start text-muted-foreground/70 group-focus-within:text-foreground has-[+input:not(:placeholder-shown)]:text-foreground absolute top-1/2 block -translate-y-1/2 cursor-text px-1 text-sm transition-all group-focus-within:pointer-events-none group-focus-within:top-0 group-focus-within:cursor-default group-focus-within:text-xs group-focus-within:font-medium has-[+input:not(:placeholder-shown)]:pointer-events-none has-[+input:not(:placeholder-shown)]:top-0 has-[+input:not(:placeholder-shown)]:cursor-default has-[+input:not(:placeholder-shown)]:text-xs has-[+input:not(:placeholder-shown)]:font-medium",children:(0,s.jsx)("span",{className:"bg-card inline-flex px-2 select-none",children:a})})}},65526:(e,r,a)=>{a.r(r),a.d(r,{AuthInitializer:()=>o});var s=a(95155),t=a(29094);let o=e=>{let{children:r}=e;return(0,t.As)(),(0,s.jsx)(s.Fragment,{children:r})}},75431:(e,r,a)=>{a.r(r),a.d(r,{useLogout:()=>n});var s=a(5041),t=a(56671),o=a(29094),i=a(35695);function n(){let e=(0,o.nc)(e=>e.clearSession),r=(0,i.useRouter)();return(0,s.useMutation)({mutationFn:()=>o.y1.logout(),onSuccess:()=>{t.oR.success("Has cerrado sesi\xf3n correctamente.")},onError:e=>{console.error("Logout error:",e),t.oR.error("Error al cerrar sesi\xf3n, pero tu sesi\xf3n local ha sido limpiada.")},onSettled:()=>{e(),r.replace("/login")}})}},75806:(e,r,a)=>{a.r(r),a.d(r,{useLogin:()=>c});var s=a(5041),t=a(56671),o=a(35695),i=a(29094),n=a(5475);function c(){let{setSession:e,markHydrated:r}=(0,i.nc)(),a=(0,o.useRouter)(),c=(0,o.useSearchParams)();return(0,s.useMutation)({mutationFn:e=>i.y1.login(e),onSuccess:async()=>{try{let s=await i.y1.me();e(s),r(),await new Promise(e=>setTimeout(e,100)),t.oR.success("\xa1Bienvenido! Has iniciado sesi\xf3n correctamente.");let o=c.get("redirect");o||(o=s.role===n.gG.ADMIN||s.role===n.gG.SUPER_ADMIN?"/dashboard":"/my-profile"),setTimeout(()=>{a.push(o)},300)}catch(e){console.error("Error processing login response:",e),t.oR.error("Error al procesar la respuesta del servidor")}},onError:e=>{console.error("Login error:",e),401===e.status?t.oR.error("Credenciales incorrectas. Verifica tu email y contrase\xf1a."):403===e.status?t.oR.error("Tu cuenta est\xe1 bloqueada. Contacta al administrador."):e.status&&e.status>=500?t.oR.error("Error del servidor. Intenta nuevamente m\xe1s tarde."):"NETWORK_ERROR"===e.code?t.oR.error("Error de conexi\xf3n. Verifica tu internet."):t.oR.error("Error al iniciar sesi\xf3n. Intenta nuevamente.")}})}},85674:(e,r,a)=>{a.r(r),a.d(r,{ClientAuthService:()=>t});var s=a(29090);class t{static async isAuthenticated(){try{return await s.y.me(),!0}catch(e){return console.error("Auth check failed:",e),!1}}static async getUser(){try{return await s.y.me()}catch(e){return console.error("Get user failed:",e),null}}static async logout(){try{await s.y.logout(),window.location.href="/login"}catch(e){console.error("Logout failed:",e),window.location.href="/login"}}}}}]);