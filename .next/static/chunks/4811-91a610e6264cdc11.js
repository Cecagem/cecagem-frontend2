"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4811],{4516:(e,a,r)=>{r.d(a,{A:()=>t});let t=(0,r(19946).A)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},19420:(e,a,r)=>{r.d(a,{A:()=>t});let t=(0,r(19946).A)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]])},28883:(e,a,r)=>{r.d(a,{A:()=>t});let t=(0,r(19946).A)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]])},42143:(e,a,r)=>{r.d(a,{D5:()=>v,Mv:()=>y,P0:()=>p,Rr:()=>d,Tm:()=>m,km:()=>h,oY:()=>g,uD:()=>u});var t=r(95838),o=r(26715),n=r(5041),i=r(56671),s=r(87481),c=r(43380);let l={companies:["accounting-clients"],companiesWithFilters:e=>["accounting-clients",e],company:e=>["accounting-clients",e],companiesStats:["accounting-clients","stats"],collaboratorsWithSearch:e=>["collaborators",e]},u=()=>(0,t.useQuery)({queryKey:l.companiesStats,queryFn:async()=>{let e=(await c.h.getCompanies({limit:1e3})).data,a=new Date,r=new Date(a.getFullYear(),a.getMonth(),1),t=e.reduce((e,a)=>e+a.contract.filter(e=>e.isActive).reduce((e,a)=>e+a.monthlyPayment,0),0);return{totalCompanies:e.length,activeCompanies:e.filter(e=>e.isActive).length,inactiveCompanies:e.filter(e=>!e.isActive).length,thisMonthCompanies:e.filter(e=>new Date(e.createdAt)>=r).length,totalRevenue:t}},retry:1,refetchOnWindowFocus:!1}),d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,t.useQuery)({queryKey:l.companiesWithFilters(e),queryFn:()=>c.h.getCompanies(e),retry:1,refetchOnWindowFocus:!0,staleTime:0})},p=e=>(0,t.useQuery)({queryKey:l.company(e),queryFn:()=>c.h.getCompanyById(e),enabled:!!e,retry:1,refetchOnWindowFocus:!1}),m=()=>{let e=(0,o.useQueryClient)();return(0,n.useMutation)({mutationFn:e=>c.h.createCompany(e),onSuccess:()=>{i.oR.success("✅ Empresa creada exitosamente"),e.invalidateQueries({queryKey:l.companies}),e.invalidateQueries({queryKey:l.companiesStats})},onError:e=>{var a,r;console.error("Error creating company:",e);let t=(null==e||null==(r=e.response)||null==(a=r.data)?void 0:a.message)||(null==e?void 0:e.message)||"";t.toLowerCase().includes("ruc")&&t.toLowerCase().includes("exist")?i.oR.error("❌ Este RUC ya est\xe1 registrado en el sistema"):t.toLowerCase().includes("email")&&t.toLowerCase().includes("exist")?i.oR.error("❌ Este email de contacto ya est\xe1 registrado"):t.toLowerCase().includes("validation")||t.toLowerCase().includes("required")||t.toLowerCase().includes("invalid")?i.oR.error("❌ Datos inv\xe1lidos: Verifica que todos los campos est\xe9n correctos"):t.toLowerCase().includes("user")&&t.toLowerCase().includes("not found")?i.oR.error("❌ El colaborador seleccionado no existe"):i.oR.error("❌ Error al crear la empresa: "+t)}})},y=()=>{let e=(0,o.useQueryClient)();return(0,n.useMutation)({mutationFn:e=>{let{id:a,data:r}=e;return c.h.updateCompany(a,r)},onSuccess:()=>{i.oR.success("✅ Empresa actualizada exitosamente"),e.invalidateQueries({queryKey:l.companies}),e.invalidateQueries({queryKey:l.companiesStats})},onError:e=>{var a,r;console.error("Error updating company:",e);let t=(null==e||null==(r=e.response)||null==(a=r.data)?void 0:a.message)||(null==e?void 0:e.message)||"";t.toLowerCase().includes("not found")?i.oR.error("❌ Empresa no encontrada"):t.toLowerCase().includes("ruc")&&t.toLowerCase().includes("exist")?i.oR.error("❌ Este RUC ya est\xe1 registrado por otra empresa"):i.oR.error("❌ Error al actualizar la empresa: "+t)}})},h=()=>{let e=(0,o.useQueryClient)();return(0,n.useMutation)({mutationFn:e=>c.h.deleteCompany(e),onSuccess:()=>{i.oR.success("✅ Empresa eliminada exitosamente"),e.invalidateQueries({queryKey:l.companies}),e.invalidateQueries({queryKey:l.companiesStats})},onError:e=>{var a,r;console.error("Error deleting company:",e);let t=(null==e||null==(r=e.response)||null==(a=r.data)?void 0:a.message)||(null==e?void 0:e.message)||"";t.toLowerCase().includes("not found")?i.oR.error("❌ Empresa no encontrada"):t.toLowerCase().includes("relation")||t.toLowerCase().includes("dependency")?i.oR.error("❌ No se puede eliminar: La empresa tiene relaciones activas"):i.oR.error("❌ Error al eliminar la empresa: "+t)}})},g=e=>{var a;let{data:r,isLoading:o,error:n,refetch:i}=(e=>(0,t.useQuery)({queryKey:l.collaboratorsWithSearch(e),queryFn:()=>c.h.getCollaborators({search:e,limit:100}),retry:1,refetchOnWindowFocus:!1}))(e);return{options:(null==r||null==(a=r.data)?void 0:a.map(e=>({value:e.id,label:"".concat(e.profile.documentNumber," - ").concat(e.profile.firstName," ").concat(e.profile.lastName),email:e.email})))||[],isLoading:o,error:n,refetch:i}},v=()=>{let e=(0,o.useQueryClient)(),{showSuccess:a,showError:r}=(0,s.d)();return(0,n.useMutation)({mutationFn:e=>{let{paymentId:a,data:r}=e;return c.h.updatePayment(a,r)},onSuccess:async r=>{await e.invalidateQueries({queryKey:l.companies}),await e.refetchQueries({queryKey:l.companies,exact:!1});let t="COMPLETED"===r.status?"aprobado":"FAILED"===r.status?"rechazado":"actualizado";a("updated",{title:"Pago actualizado",description:"El pago ha sido ".concat(t," exitosamente")})},onError:e=>{r("error",{title:"Error al actualizar pago",description:(null==e?void 0:e.message)||"No se pudo actualizar el pago"})}})}},43380:(e,a,r)=>{r.d(a,{h:()=>n});var t=r(90697);let o={companies:"/companies",company:e=>"/companies/".concat(e),collaborators:"/users"},n={async getCompanies(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=new URLSearchParams;return a.append("page",(e.page||1).toString()),a.append("limit",(e.limit||10).toString()),e.search&&a.append("search",e.search),void 0!==e.isActive&&a.append("isActive",e.isActive.toString()),e.ruc&&a.append("ruc",e.ruc),e.businessName&&a.append("businessName",e.businessName),e.tradeName&&a.append("tradeName",e.tradeName),await t.q.get("".concat(o.companies,"?").concat(a.toString()))},getCompanyById:async e=>await t.q.get(o.company(e)),async createCompany(e){try{return await t.q.post(o.companies,e)}catch(e){throw console.error("❌ Error al crear empresa:",e),e}},async updateCompany(e,a){try{return await t.q.patch(o.company(e),a)}catch(e){throw console.error("❌ Error al actualizar empresa:",e),e}},async deleteCompany(e){try{await t.q.delete(o.company(e))}catch(e){throw console.error("❌ Error al eliminar empresa:",e),e}},async getCollaborators(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=new URLSearchParams;return a.append("role","COLLABORATOR_INTERNAL"),a.append("type","users_system"),a.append("page",(e.page||1).toString()),a.append("limit",(e.limit||50).toString()),e.search&&a.append("search",e.search),await t.q.get("".concat(o.collaborators,"?").concat(a.toString()))},updatePayment:async(e,a)=>await t.q.patch("/payments/".concat(e),a)}},85339:(e,a,r)=>{r.d(a,{A:()=>t});let t=(0,r(19946).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},87481:(e,a,r)=>{r.d(a,{d:()=>u});var t=r(12115),o=r(56671),n=r(43453),i=r(85339),s=r(1243),c=r(81284);let l={success:{created:{title:"\xa1Operaci\xf3n exitosa!",description:"El elemento ha sido creado correctamente."},updated:{title:"\xa1Actualizaci\xf3n exitosa!",description:"Los cambios han sido guardados correctamente."},deleted:{title:"\xa1Eliminaci\xf3n exitosa!",description:"El elemento ha sido eliminado del sistema."}},error:{error:{title:"Error en la operaci\xf3n",description:"Ha ocurrido un problema. Por favor intenta nuevamente."},created:{title:"Error al crear",description:"No se pudo crear el elemento. Verifica los datos e intenta nuevamente."},updated:{title:"Error al actualizar",description:"No se pudieron guardar los cambios. Intenta nuevamente."},deleted:{title:"Error al eliminar",description:"No se pudo eliminar el elemento. Intenta nuevamente."}},warning:{created:{title:"Creado con advertencias",description:"La operaci\xf3n se complet\xf3 pero hay algunos aspectos a revisar."},updated:{title:"Actualizado con advertencias",description:"Los cambios se guardaron pero hay algunos aspectos a revisar."},deleted:{title:"Eliminado con advertencias",description:"La eliminaci\xf3n se complet\xf3 pero hay algunos aspectos a revisar."}},info:{created:{title:"Informaci\xf3n",description:"El elemento ha sido creado. Revisa los detalles adicionales."},updated:{title:"Informaci\xf3n",description:"Los cambios han sido aplicados. Revisa los detalles."},deleted:{title:"Informaci\xf3n",description:"El elemento ha sido eliminado del sistema."}}};function u(){let e=(e,a,r)=>{var u;let d=a&&(null==(u=l[e])?void 0:u[a]),p=(null==r?void 0:r.title)||(null==d?void 0:d.title)||"Notificaci\xf3n",m={description:(null==r?void 0:r.description)||(null==d?void 0:d.description),duration:(null==r?void 0:r.duration)||4e3,icon:t.createElement(function(e){switch(e){case"success":return n.A;case"error":return i.A;case"warning":return s.A;default:return c.A}}(e),{className:"h-4 w-4"})};switch(e){case"success":o.oR.success(p,m);break;case"error":o.oR.error(p,m);break;case"warning":o.oR.warning(p,m);break;case"info":o.oR.info(p,m);break;default:(0,o.oR)(p,m)}};return{showToast:e,showSuccess:(a,r)=>{e("success",a,r)},showError:(a,r)=>{e("error",a,r)},showWarning:(a,r)=>{e("warning",a,r)},showInfo:(a,r)=>{e("info",a,r)},showCustomSuccess:(a,r,t)=>{e("success",void 0,{title:a,description:r,duration:t})},showCustomError:(a,r,t)=>{e("error",void 0,{title:a,description:r,duration:t})},showCustomWarning:(a,r,t)=>{e("warning",void 0,{title:a,description:r,duration:t})},showCustomInfo:(a,r,t)=>{e("info",void 0,{title:a,description:r,duration:t})}}}}}]);