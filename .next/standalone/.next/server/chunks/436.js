"use strict";exports.id=436,exports.ids=[436],exports.modules={16023:(a,b,c)=>{c.d(b,{A:()=>d});let d=(0,c(62688).A)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]])},19378:(a,b,c)=>{c.d(b,{q:()=>q});var d=c(60687),e=c(43210),f=c(63503),g=c(44493),h=c(96834),i=c(29523),j=c(5336),k=c(11860),l=c(48730),m=c(93613),n=c(85778),o=c(40228),p=c(24961);let q=({open:a,onOpenChange:b,payments:c,installmentDescription:q="Cuota",canManagePayments:r=!1})=>{let[s,t]=(0,e.useState)(null),u=(0,p.D5)(),v=async a=>{t(a);try{await u.mutateAsync({paymentId:a,data:{status:"COMPLETED"}}),b(!1)}catch(a){console.error("Error al aprobar pago:",a)}finally{t(null)}},w=async a=>{t(a);try{await u.mutateAsync({paymentId:a,data:{status:"FAILED"}}),b(!1)}catch(a){console.error("Error al rechazar pago:",a)}finally{t(null)}};return(0,d.jsx)(f.lG,{open:a,onOpenChange:b,children:(0,d.jsxs)(f.Cf,{className:"sm:max-w-[600px] max-w-[95vw] max-h-[90vh] overflow-y-auto",children:[(0,d.jsxs)(f.c7,{children:[(0,d.jsxs)(f.L3,{className:"flex items-center gap-2",children:[(0,d.jsx)(n.A,{className:"h-5 w-5"}),"Pagos de ",q]}),(0,d.jsx)(f.rr,{children:"Detalle de los pagos realizados para esta cuota"})]}),(0,d.jsx)("div",{className:"space-y-4",children:(0,d.jsxs)("div",{className:"space-y-3",children:[(0,d.jsx)("h4",{className:"font-medium text-sm text-muted-foreground",children:"Historial de Pagos"}),c.length>0?(0,d.jsx)("div",{className:"space-y-3",children:c.map((a,b)=>{let c;return(0,d.jsx)(g.Zp,{className:`border-l-4 ${"COMPLETED"===a.status?"border-l-green-500":"FAILED"===a.status?"border-l-red-500":"PENDING"===a.status?"border-l-yellow-500":"border-l-gray-500"}`,children:(0,d.jsx)(g.Wu,{className:"p-4",children:(0,d.jsxs)("div",{className:"space-y-3",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsx)("div",{className:`h-10 w-10 rounded-full flex items-center justify-center ${"COMPLETED"===a.status?"bg-green-100 dark:bg-green-900/30":"FAILED"===a.status?"bg-red-100 dark:bg-red-900/30":"PENDING"===a.status?"bg-yellow-100 dark:bg-yellow-900/30":"bg-gray-100 dark:bg-gray-900/30"}`,children:(a=>{switch(a){case"COMPLETED":return(0,d.jsx)(j.A,{className:"h-4 w-4 text-green-600"});case"FAILED":return(0,d.jsx)(k.A,{className:"h-4 w-4 text-red-600"});case"PENDING":return(0,d.jsx)(l.A,{className:"h-4 w-4 text-yellow-600"});default:return(0,d.jsx)(m.A,{className:"h-4 w-4 text-gray-600"})}})(a.status)}),(0,d.jsxs)("div",{children:[(0,d.jsxs)("p",{className:"font-medium text-sm",children:["Pago #",b+1]}),(0,d.jsxs)("p",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[(0,d.jsx)(o.A,{className:"h-3 w-3"}),new Date(a.createdAt).toLocaleDateString("es-PE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})]})]})]}),(0,d.jsx)("div",{className:"text-right",children:(0,d.jsx)(h.E,{className:(a=>{switch(a){case"COMPLETED":return"bg-green-100 dark:bg-green-900/20 text-green-800 dark:text-green-300";case"FAILED":return"bg-red-100 dark:bg-red-900/20 text-red-800 dark:text-red-300";case"PENDING":return"bg-yellow-100 dark:bg-yellow-900/20 text-yellow-800 dark:text-yellow-300";default:return"bg-gray-100 dark:bg-gray-900/20 text-gray-800 dark:text-gray-300"}})(a.status),children:(a=>{switch(a){case"COMPLETED":return"Aprobado";case"FAILED":return"Rechazado";case"PENDING":return"Pendiente";default:return a}})(a.status)})})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 text-sm",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-muted-foreground",children:"Monto"}),(0,d.jsx)("p",{className:"font-semibold",children:(c=a.amount,new Intl.NumberFormat("es-PE",{style:"currency",currency:"PEN",minimumFractionDigits:2}).format(c))})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-muted-foreground",children:"M\xe9todo"}),(0,d.jsx)("p",{className:"font-medium",children:a.method})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-muted-foreground",children:"Nro. Operaci\xf3n"}),(0,d.jsx)("p",{className:"font-mono text-xs",children:a.reference||"No especificado"})]})]}),r&&"PENDING"===a.status&&(0,d.jsxs)("div",{className:"flex gap-2 pt-2 border-t",children:[(0,d.jsxs)(i.$,{size:"sm",onClick:()=>v(a.id),disabled:s===a.id,className:"flex-1 bg-green-600 hover:bg-green-700",children:[(0,d.jsx)(j.A,{className:"h-4 w-4 mr-2"}),s===a.id?"Aprobando...":"Aprobar"]}),(0,d.jsxs)(i.$,{size:"sm",variant:"destructive",onClick:()=>w(a.id),disabled:s===a.id,className:"flex-1",children:[(0,d.jsx)(k.A,{className:"h-4 w-4 mr-2"}),s===a.id?"Rechazando...":"Rechazar"]})]})]})})},a.id)})}):(0,d.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,d.jsx)(n.A,{className:"h-12 w-12 mx-auto text-muted-foreground/50 mb-4"}),(0,d.jsx)("p",{className:"text-sm",children:"No hay pagos registrados para esta cuota"})]})]})})]})})}},24961:(a,b,c)=>{c.d(b,{D5:()=>o,U0:()=>n,k6:()=>m,ku:()=>k,n:()=>j,n9:()=>l});var d=c(12030),e=c(8693),f=c(54050),g=c(61714),h=c(29867);let i={all:["contracts"],lists:()=>[...i.all,"list"],list:a=>[...i.lists(),a],details:()=>[...i.all,"detail"],detail:a=>[...i.details(),a]},j=(a={})=>(0,d.useQuery)({queryKey:i.list(a),queryFn:()=>g.U.getContracts(a),retry:1,refetchOnWindowFocus:!0,staleTime:0}),k=a=>(0,d.useQuery)({queryKey:i.detail(a),queryFn:()=>g.U.getContractById(a),enabled:!!a,retry:1,refetchOnWindowFocus:!1}),l=()=>{let a=(0,e.useQueryClient)(),{showSuccess:b,showError:c}=(0,h.d)();return(0,f.useMutation)({mutationFn:a=>g.U.deleteContract(a),onSuccess:(c,d)=>{a.invalidateQueries({queryKey:i.all}),a.removeQueries({queryKey:i.detail(d)}),b("deleted",{title:"Contrato eliminado",description:c.message||"El contrato ha sido eliminado exitosamente"})},onError:a=>{c("error",{title:"Error al eliminar",description:a?.message||"No se pudo eliminar el contrato"})}})},m=()=>{let a=(0,e.useQueryClient)(),{showSuccess:b,showError:c}=(0,h.d)();return(0,f.useMutation)({mutationFn:({contractId:a,deliverableId:b,data:c})=>g.U.updateDeliverable(a,b,c),onSuccess:async c=>{await a.invalidateQueries({queryKey:i.all}),await a.invalidateQueries({queryKey:i.lists()}),await a.refetchQueries({queryKey:i.lists(),exact:!1});let d="Entregable actualizado",e="El entregable ha sido actualizado exitosamente";!0===c.isAproved&&!0===c.isCompleted?(d="Entregable aprobado",e="El entregable ha sido aprobado exitosamente"):!1===c.isAproved&&!1===c.isCompleted&&(d="Entregable rechazado",e="El entregable ha sido rechazado y vuelve a estar en progreso"),b("updated",{title:d,description:e})},onError:a=>{c("error",{title:"Error al actualizar",description:a?.message||"No se pudo actualizar el entregable"})}})},n=()=>{let a=(0,e.useQueryClient)(),{showSuccess:b,showError:c}=(0,h.d)();return(0,f.useMutation)({mutationFn:a=>g.U.createContract(a),onSuccess:c=>(a.invalidateQueries({queryKey:i.all}),b("created",{title:"Contrato creado",description:`El contrato "${c.name}" ha sido creado exitosamente`}),c),onError:a=>{c("error",{title:"Error al crear",description:a?.message||"No se pudo crear el contrato"})}})},o=()=>{let a=(0,e.useQueryClient)(),{showSuccess:b,showError:c}=(0,h.d)();return(0,f.useMutation)({mutationFn:({paymentId:a,data:b})=>g.U.updatePayment(a,b),onSuccess:async c=>{await a.invalidateQueries({queryKey:i.all}),await a.invalidateQueries({queryKey:i.lists()}),await a.refetchQueries({queryKey:i.lists(),exact:!1});let d="COMPLETED"===c.status?"aprobado":"FAILED"===c.status?"rechazado":"actualizado";b("updated",{title:"Pago actualizado",description:`El pago ha sido ${d} exitosamente`})},onError:a=>{c("error",{title:"Error al actualizar pago",description:a?.message||"No se pudo actualizar el pago"})}})}},29867:(a,b,c)=>{c.d(b,{d:()=>l});var d=c(43210),e=c.n(d),f=c(52581),g=c(14719),h=c(93613),i=c(43649),j=c(96882);let k={success:{created:{title:"\xa1Operaci\xf3n exitosa!",description:"El elemento ha sido creado correctamente."},updated:{title:"\xa1Actualizaci\xf3n exitosa!",description:"Los cambios han sido guardados correctamente."},deleted:{title:"\xa1Eliminaci\xf3n exitosa!",description:"El elemento ha sido eliminado del sistema."}},error:{error:{title:"Error en la operaci\xf3n",description:"Ha ocurrido un problema. Por favor intenta nuevamente."},created:{title:"Error al crear",description:"No se pudo crear el elemento. Verifica los datos e intenta nuevamente."},updated:{title:"Error al actualizar",description:"No se pudieron guardar los cambios. Intenta nuevamente."},deleted:{title:"Error al eliminar",description:"No se pudo eliminar el elemento. Intenta nuevamente."}},warning:{created:{title:"Creado con advertencias",description:"La operaci\xf3n se complet\xf3 pero hay algunos aspectos a revisar."},updated:{title:"Actualizado con advertencias",description:"Los cambios se guardaron pero hay algunos aspectos a revisar."},deleted:{title:"Eliminado con advertencias",description:"La eliminaci\xf3n se complet\xf3 pero hay algunos aspectos a revisar."}},info:{created:{title:"Informaci\xf3n",description:"El elemento ha sido creado. Revisa los detalles adicionales."},updated:{title:"Informaci\xf3n",description:"Los cambios han sido aplicados. Revisa los detalles."},deleted:{title:"Informaci\xf3n",description:"El elemento ha sido eliminado del sistema."}}};function l(){let a=(a,b,c)=>{let d=b&&k[a]?.[b],l=c?.title||d?.title||"Notificaci\xf3n",m={description:c?.description||d?.description,duration:c?.duration||4e3,icon:e().createElement(function(a){switch(a){case"success":return g.A;case"error":return h.A;case"warning":return i.A;default:return j.A}}(a),{className:"h-4 w-4"})};switch(a){case"success":f.oR.success(l,m);break;case"error":f.oR.error(l,m);break;case"warning":f.oR.warning(l,m);break;case"info":f.oR.info(l,m);break;default:(0,f.oR)(l,m)}};return{showToast:a,showSuccess:(b,c)=>{a("success",b,c)},showError:(b,c)=>{a("error",b,c)},showWarning:(b,c)=>{a("warning",b,c)},showInfo:(b,c)=>{a("info",b,c)},showCustomSuccess:(b,c,d)=>{a("success",void 0,{title:b,description:c,duration:d})},showCustomError:(b,c,d)=>{a("error",void 0,{title:b,description:c,duration:d})},showCustomWarning:(b,c,d)=>{a("warning",void 0,{title:b,description:c,duration:d})},showCustomInfo:(b,c,d)=>{a("info",void 0,{title:b,description:c,duration:d})}}}},34729:(a,b,c)=>{c.d(b,{T:()=>f});var d=c(60687);c(43210);var e=c(4780);function f({className:a,...b}){return(0,d.jsx)("textarea",{className:(0,e.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-xs placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),...b})}},58887:(a,b,c)=>{c.d(b,{A:()=>d});let d=(0,c(62688).A)("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]])},61714:(a,b,c)=>{c.d(b,{U:()=>g});var d=c(86401);let e={contracts:"/contract",contract:a=>`/contract/${a}`,deliverable:(a,b)=>`/contract/${a}/deliverables/${b}`};class f{async getContracts(a={}){let b=new URLSearchParams;a.page&&b.append("page",a.page.toString()),a.limit&&b.append("limit",a.limit.toString()),a.search&&b.append("search",a.search),a.serviceId&&b.append("serviceId",a.serviceId),a.sortBy&&b.append("sortBy",a.sortBy),a.sortOrder&&b.append("sortOrder",a.sortOrder);let c=b.toString(),f=c?`${e.contracts}?${c}`:e.contracts;return await d.q.get(f)}async getContractById(a){return await d.q.get(e.contract(a))}async deleteContract(a){return await d.q.delete(e.contract(a))}async createContract(a){return await d.q.post(e.contracts,a)}async updateContract(a,b){return await d.q.patch(e.contract(a),b)}async updateDeliverable(a,b,c){return await d.q.patch(e.deliverable(a,b),c)}async updatePayment(a,b){return await d.q.patch(`/payments/${a}`,b)}}let g=new f;c(66666)},66666:(a,b,c)=>{c.d(b,{M:()=>f});var d=c(86401);class e{async createPayment(a){return await d.q.post("/payments",a)}}let f=new e},85763:(a,b,c)=>{c.d(b,{Xi:()=>i,av:()=>j,j7:()=>h,tU:()=>g});var d=c(60687);c(43210);var e=c(85068),f=c(4780);function g({className:a,...b}){return(0,d.jsx)(e.bL,{"data-slot":"tabs",className:(0,f.cn)("flex flex-col gap-2",a),...b})}function h({className:a,...b}){return(0,d.jsx)(e.B8,{"data-slot":"tabs-list",className:(0,f.cn)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",a),...b})}function i({className:a,...b}){return(0,d.jsx)(e.l9,{"data-slot":"tabs-trigger",className:(0,f.cn)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),...b})}function j({className:a,...b}){return(0,d.jsx)(e.UC,{"data-slot":"tabs-content",className:(0,f.cn)("flex-1 outline-none",a),...b})}}};