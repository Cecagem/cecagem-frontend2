(()=>{var a={};a.id=298,a.ids=[298],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12412:a=>{"use strict";a.exports=require("assert")},19121:a=>{"use strict";a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},20166:(a,b,c)=>{"use strict";c.d(b,{V:()=>g});var d=c(86401);class e{async getServices(a){let b=new URLSearchParams;a?.page&&b.append("page",a.page.toString()),a?.limit&&b.append("limit",a.limit.toString()),a?.search&&b.append("search",a.search),a?.isActive!==void 0&&b.append("isActive",a.isActive.toString());let c=b.toString(),e=c?`${this.baseEndpoint}?${c}`:this.baseEndpoint;return await d.q.get(e)}async getServiceById(a){return await d.q.get(`${this.baseEndpoint}/${a}`)}async createService(a){return await d.q.post(this.baseEndpoint,a)}async updateService(a,b){return await d.q.patch(`${this.baseEndpoint}/${a}`,b)}async deleteService(a){return await d.q.delete(`${this.baseEndpoint}/${a}`)}async getDeliverablesByServiceId(a){return await d.q.get(`${this.baseEndpoint}/${a}/deliverables`)}constructor(){this.baseEndpoint="/engagements"}}let f=new e,g={getServices:a=>f.getServices(a),getServiceById:a=>f.getServiceById(a),createService:a=>f.createService(a),updateService:(a,b)=>f.updateService(a,b),deleteService:a=>f.deleteService(a),getDeliverablesByServiceId:a=>f.getDeliverablesByServiceId(a)}},21820:a=>{"use strict";a.exports=require("os")},25541:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(62688).A)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]])},26713:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/is-bot")},27910:a=>{"use strict";a.exports=require("stream")},28354:a=>{"use strict";a.exports=require("util")},29021:a=>{"use strict";a.exports=require("fs")},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:a=>{"use strict";a.exports=require("path")},35768:(a,b,c)=>{"use strict";c.d(b,{A$:()=>j,EQ:()=>n,Rv:()=>k,iM:()=>l,if:()=>m});var d=c(12030),e=c(8693),f=c(54050),g=c(20166),h=c(29867);let i={all:["engagements"],lists:()=>[...i.all,"list"],list:a=>[...i.lists(),a],details:()=>[...i.all,"detail"],detail:a=>[...i.details(),a],deliverables:()=>[...i.all,"deliverables"],deliverablesList:a=>[...i.deliverables(),a]},j=a=>(0,d.useQuery)({queryKey:i.list(a),queryFn:()=>g.V.getServices(a),refetchOnWindowFocus:!0,staleTime:0}),k=()=>{let a=(0,e.useQueryClient)(),{showSuccess:b,showError:c}=(0,h.d)();return(0,f.useMutation)({mutationFn:g.V.createService,onSuccess:()=>{b("created",{title:"Servicio creado",description:"El servicio  ha sido creado exitosamente."}),a.invalidateQueries({queryKey:i.lists()}),a.invalidateQueries({queryKey:["all-services-for-select"]}),a.invalidateQueries({queryKey:["services-for-select"]})},onError:a=>{console.error("Error creating service:",a),c("error",{title:"Error creando servicio",description:`No se pudo crear el servicio: ${a.message}`})}})},l=()=>{let a=(0,e.useQueryClient)();return(0,f.useMutation)({mutationFn:({serviceId:a,serviceData:b})=>g.V.updateService(a,b),onSuccess:(b,c)=>{a.invalidateQueries({queryKey:i.lists()}),a.invalidateQueries({queryKey:i.detail(c.serviceId)}),a.invalidateQueries({queryKey:["all-services-for-select"]}),a.invalidateQueries({queryKey:["services-for-select"]})},onError:a=>{console.error("Error updating service:",a)}})},m=()=>{let a=(0,e.useQueryClient)();return(0,f.useMutation)({mutationFn:g.V.deleteService,onSuccess:()=>{a.invalidateQueries({queryKey:i.lists()}),a.invalidateQueries({queryKey:["all-services-for-select"]}),a.invalidateQueries({queryKey:["services-for-select"]})},onError:a=>{console.error("Error deleting service:",a)}})},n=a=>(0,d.useQuery)({queryKey:i.deliverablesList(a),queryFn:()=>g.V.getDeliverablesByServiceId(a),enabled:!!a,staleTime:3e5,gcTime:6e5})},41025:a=>{"use strict";a.exports=require("next/dist/server/app-render/dynamic-access-async-storage.external.js")},53733:(a,b,c)=>{Promise.resolve().then(c.bind(c,83934))},55511:a=>{"use strict";a.exports=require("crypto")},55591:a=>{"use strict";a.exports=require("https")},61944:(a,b,c)=>{"use strict";c.r(b),c.d(b,{GlobalError:()=>C.a,__next_app__:()=>I,handler:()=>K,pages:()=>H,routeModule:()=>J,tree:()=>G});var d=c(65239),e=c(48088),f=c(47220),g=c(81289),h=c(26191),i=c(14823),j=c(71998),k=c(92603),l=c(54649),m=c(32781),n=c(82602),o=c(61268),p=c(4853),q=c(261),r=c(5052),s=c(9977),t=c(26713),u=c(43365),v=c(71454),w=c(67778),x=c(46143),y=c(39105),z=c(38171),A=c(86439),B=c(16133),C=c.n(B),D=c(30893),E=c(52836),F={};for(let a in D)0>["default","tree","pages","GlobalError","__next_app__","routeModule","handler"].indexOf(a)&&(F[a]=()=>D[a]);c.d(b,F);let G={children:["",{children:["(admin)",{children:["contract",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(c.bind(c,83934)),"D:\\ECOMAS\\testing\\crud-alvaro\\cecagem\\cecagem-frontend2\\src\\app\\(admin)\\contract\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(c.bind(c,10814)),"D:\\ECOMAS\\testing\\crud-alvaro\\cecagem\\cecagem-frontend2\\src\\app\\(admin)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(c.t.bind(c,80849,23)),"next/dist/client/components/builtin/not-found.js"],forbidden:[()=>Promise.resolve().then(c.t.bind(c,29868,23)),"next/dist/client/components/builtin/forbidden.js"],unauthorized:[()=>Promise.resolve().then(c.t.bind(c,79615,23)),"next/dist/client/components/builtin/unauthorized.js"],metadata:{icon:[async a=>(await Promise.resolve().then(c.bind(c,70440))).default(a)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(c.bind(c,94431)),"D:\\ECOMAS\\testing\\crud-alvaro\\cecagem\\cecagem-frontend2\\src\\app\\layout.tsx"],"global-error":[()=>Promise.resolve().then(c.t.bind(c,16133,23)),"next/dist/client/components/builtin/global-error.js"],"not-found":[()=>Promise.resolve().then(c.t.bind(c,80849,23)),"next/dist/client/components/builtin/not-found.js"],forbidden:[()=>Promise.resolve().then(c.t.bind(c,29868,23)),"next/dist/client/components/builtin/forbidden.js"],unauthorized:[()=>Promise.resolve().then(c.t.bind(c,79615,23)),"next/dist/client/components/builtin/unauthorized.js"],metadata:{icon:[async a=>(await Promise.resolve().then(c.bind(c,70440))).default(a)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,H=["D:\\ECOMAS\\testing\\crud-alvaro\\cecagem\\cecagem-frontend2\\src\\app\\(admin)\\contract\\page.tsx"],I={require:c,loadChunk:()=>Promise.resolve()},J=new d.AppPageRouteModule({definition:{kind:e.RouteKind.APP_PAGE,page:"/(admin)/contract/page",pathname:"/contract",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:G},distDir:".next",projectDir:""});async function K(a,b,c){var d;let B="/(admin)/contract/page";"/index"===B&&(B="/");let F="false",L=(0,h.getRequestMeta)(a,"postponed"),M=(0,h.getRequestMeta)(a,"minimalMode"),N=await J.prepare(a,b,{srcPage:B,multiZoneDraftMode:F});if(!N)return b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve()),null;let{buildId:O,query:P,params:Q,parsedUrl:R,pageIsDynamic:S,buildManifest:T,nextFontManifest:U,reactLoadableManifest:V,serverActionsManifest:W,clientReferenceManifest:X,subresourceIntegrityManifest:Y,prerenderManifest:Z,isDraftMode:$,resolvedPathname:_,revalidateOnlyGenerated:aa,routerServerContext:ab,nextConfig:ac}=N,ad=R.pathname||"/",ae=(0,q.normalizeAppPath)(B),{isOnDemandRevalidate:af}=N,ag=Z.dynamicRoutes[ae],ah=Z.routes[_],ai=!!(ag||ah||Z.routes[ae]),aj=a.headers["user-agent"]||"",ak=(0,t.getBotType)(aj),al=(0,o.isHtmlBotRequest)(a),am=(0,h.getRequestMeta)(a,"isPrefetchRSCRequest")??!!a.headers[s.NEXT_ROUTER_PREFETCH_HEADER],an=(0,h.getRequestMeta)(a,"isRSCRequest")??!!a.headers[s.RSC_HEADER],ao=(0,r.getIsPossibleServerAction)(a),ap=(0,l.checkIsAppPPREnabled)(ac.experimental.ppr)&&(null==(d=Z.routes[ae]??Z.dynamicRoutes[ae])?void 0:d.renderingMode)==="PARTIALLY_STATIC",aq=!1,ar=!1,as=ap?L:void 0,at=ap&&an&&!am,au=(0,h.getRequestMeta)(a,"segmentPrefetchRSCRequest"),av=!aj||(0,o.shouldServeStreamingMetadata)(aj,ac.htmlLimitedBots);al&&ap&&(ai=!1,av=!1);let aw=!0===J.isDev||!ai||"string"==typeof L||at,ax=al&&ap,ay=null;$||!ai||aw||ao||as||at||(ay=_);let az=ay;!az&&J.isDev&&(az=_);let aA={...D,tree:G,pages:H,GlobalError:C(),handler:K,routeModule:J,__next_app__:I};W&&X&&(0,n.setReferenceManifestsSingleton)({page:B,clientReferenceManifest:X,serverActionsManifest:W,serverModuleMap:(0,p.createServerModuleMap)({serverActionsManifest:W})});let aB=a.method||"GET",aC=(0,g.getTracer)(),aD=aC.getActiveScopeSpan();try{let d=async(c,d)=>{let e=new k.NodeNextRequest(a),f=new k.NodeNextResponse(b);return J.render(e,f,d).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=aC.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==i.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${aB} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${aB} ${a.url}`)})},f=async({span:e,postponed:f,fallbackRouteParams:g})=>{let i={query:P,params:Q,page:ae,sharedContext:{buildId:O},serverComponentsHmrCache:(0,h.getRequestMeta)(a,"serverComponentsHmrCache"),fallbackRouteParams:g,renderOpts:{App:()=>null,Document:()=>null,pageConfig:{},ComponentMod:aA,Component:(0,j.T)(aA),params:Q,routeModule:J,page:B,postponed:f,shouldWaitOnAllReady:ax,serveStreamingMetadata:av,supportsDynamicResponse:"string"==typeof f||aw,buildManifest:T,nextFontManifest:U,reactLoadableManifest:V,subresourceIntegrityManifest:Y,serverActionsManifest:W,clientReferenceManifest:X,setIsrStatus:null==ab?void 0:ab.setIsrStatus,dir:J.projectDir,isDraftMode:$,isRevalidate:ai&&!f&&!at,botType:ak,isOnDemandRevalidate:af,isPossibleServerAction:ao,assetPrefix:ac.assetPrefix,nextConfigOutput:ac.output,crossOrigin:ac.crossOrigin,trailingSlash:ac.trailingSlash,previewProps:Z.preview,deploymentId:ac.deploymentId,enableTainting:ac.experimental.taint,htmlLimitedBots:ac.htmlLimitedBots,devtoolSegmentExplorer:ac.experimental.devtoolSegmentExplorer,reactMaxHeadersLength:ac.reactMaxHeadersLength,multiZoneDraftMode:F,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:ac.experimental.cacheLife,basePath:ac.basePath,serverActions:ac.experimental.serverActions,...aq?{nextExport:!0,supportsDynamicResponse:!1,isStaticGeneration:!0,isRevalidate:!0,isDebugDynamicAccesses:aq}:{},experimental:{isRoutePPREnabled:ap,expireTime:ac.expireTime,staleTimes:ac.experimental.staleTimes,dynamicIO:!!ac.experimental.dynamicIO,clientSegmentCache:!!ac.experimental.clientSegmentCache,dynamicOnHover:!!ac.experimental.dynamicOnHover,inlineCss:!!ac.experimental.inlineCss,authInterrupts:!!ac.experimental.authInterrupts,clientTraceMetadata:ac.experimental.clientTraceMetadata||[]},waitUntil:c.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:()=>{},onInstrumentationRequestError:(b,c,d)=>J.onRequestError(a,b,d,ab),err:(0,h.getRequestMeta)(a,"invokeError"),dev:J.isDev}},k=await d(e,i),{metadata:l}=k,{cacheControl:m,headers:n={},fetchTags:o}=l;if(o&&(n[x.NEXT_CACHE_TAGS_HEADER]=o),a.fetchMetrics=l.fetchMetrics,ai&&(null==m?void 0:m.revalidate)===0&&!J.isDev&&!ap){let a=l.staticBailoutInfo,b=Object.defineProperty(Error(`Page changed from static to dynamic at runtime ${_}${(null==a?void 0:a.description)?`, reason: ${a.description}`:""}
see more here https://nextjs.org/docs/messages/app-static-to-dynamic-error`),"__NEXT_ERROR_CODE",{value:"E132",enumerable:!1,configurable:!0});if(null==a?void 0:a.stack){let c=a.stack;b.stack=b.message+c.substring(c.indexOf("\n"))}throw b}return{value:{kind:u.CachedRouteKind.APP_PAGE,html:k,headers:n,rscData:l.flightData,postponed:l.postponed,status:l.statusCode,segmentData:l.segmentData},cacheControl:m}},l=async({hasResolved:d,previousCacheEntry:g,isRevalidating:i,span:j})=>{let k,l=!1===J.isDev,n=d||b.writableEnded;if(af&&aa&&!g&&!M)return(null==ab?void 0:ab.render404)?await ab.render404(a,b):(b.statusCode=404,b.end("This page could not be found")),null;if(ag&&(k=(0,v.parseFallbackField)(ag.fallback)),k===v.FallbackMode.PRERENDER&&(0,t.isBot)(aj)&&(k=v.FallbackMode.BLOCKING_STATIC_RENDER),(null==g?void 0:g.isStale)===-1&&(af=!0),af&&(k!==v.FallbackMode.NOT_FOUND||g)&&(k=v.FallbackMode.BLOCKING_STATIC_RENDER),!M&&k!==v.FallbackMode.BLOCKING_STATIC_RENDER&&az&&!n&&!$&&S&&(l||!ah)){let b;if((l||ag)&&k===v.FallbackMode.NOT_FOUND)throw new A.NoFallbackError;if(ap&&!an){if(b=await J.handleResponse({cacheKey:l?ae:null,req:a,nextConfig:ac,routeKind:e.RouteKind.APP_PAGE,isFallback:!0,prerenderManifest:Z,isRoutePPREnabled:ap,responseGenerator:async()=>f({span:j,postponed:void 0,fallbackRouteParams:l||ar?(0,m.u)(ae):null}),waitUntil:c.waitUntil}),null===b)return null;if(b)return delete b.cacheControl,b}}let o=af||i||!as?void 0:as;if(aq&&void 0!==o)return{cacheControl:{revalidate:1,expire:void 0},value:{kind:u.CachedRouteKind.PAGES,html:w.default.fromStatic(""),pageData:{},headers:void 0,status:void 0}};let p=S&&ap&&((0,h.getRequestMeta)(a,"renderFallbackShell")||ar)?(0,m.u)(ad):null;return f({span:j,postponed:o,fallbackRouteParams:p})},n=async d=>{var g,i,j,k,m;let n,o=await J.handleResponse({cacheKey:ay,responseGenerator:a=>l({span:d,...a}),routeKind:e.RouteKind.APP_PAGE,isOnDemandRevalidate:af,isRoutePPREnabled:ap,req:a,nextConfig:ac,prerenderManifest:Z,waitUntil:c.waitUntil});if($&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate"),J.isDev&&b.setHeader("Cache-Control","no-store, must-revalidate"),!o){if(ay)throw Object.defineProperty(Error("invariant: cache entry required but not generated"),"__NEXT_ERROR_CODE",{value:"E62",enumerable:!1,configurable:!0});return null}if((null==(g=o.value)?void 0:g.kind)!==u.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant app-page handler received invalid cache entry ${null==(j=o.value)?void 0:j.kind}`),"__NEXT_ERROR_CODE",{value:"E707",enumerable:!1,configurable:!0});let p="string"==typeof o.value.postponed;ai&&!at&&(!p||am)&&(M||b.setHeader("x-nextjs-cache",af?"REVALIDATED":o.isMiss?"MISS":o.isStale?"STALE":"HIT"),b.setHeader(s.NEXT_IS_PRERENDER_HEADER,"1"));let{value:q}=o;if(as)n={revalidate:0,expire:void 0};else if(M&&an&&!am&&ap)n={revalidate:0,expire:void 0};else if(!J.isDev)if($)n={revalidate:0,expire:void 0};else if(ai){if(o.cacheControl)if("number"==typeof o.cacheControl.revalidate){if(o.cacheControl.revalidate<1)throw Object.defineProperty(Error(`Invalid revalidate configuration provided: ${o.cacheControl.revalidate} < 1`),"__NEXT_ERROR_CODE",{value:"E22",enumerable:!1,configurable:!0});n={revalidate:o.cacheControl.revalidate,expire:(null==(k=o.cacheControl)?void 0:k.expire)??ac.expireTime}}else n={revalidate:x.CACHE_ONE_YEAR,expire:void 0}}else b.getHeader("Cache-Control")||(n={revalidate:0,expire:void 0});if(o.cacheControl=n,"string"==typeof au&&(null==q?void 0:q.kind)===u.CachedRouteKind.APP_PAGE&&q.segmentData){b.setHeader(s.NEXT_DID_POSTPONE_HEADER,"2");let c=null==(m=q.headers)?void 0:m[x.NEXT_CACHE_TAGS_HEADER];M&&ai&&c&&"string"==typeof c&&b.setHeader(x.NEXT_CACHE_TAGS_HEADER,c);let d=q.segmentData.get(au);return void 0!==d?(0,z.sendRenderResult)({req:a,res:b,type:"rsc",generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:w.default.fromStatic(d),cacheControl:o.cacheControl}):(b.statusCode=204,(0,z.sendRenderResult)({req:a,res:b,type:"rsc",generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:w.default.fromStatic(""),cacheControl:o.cacheControl}))}let r=(0,h.getRequestMeta)(a,"onCacheEntry");if(r&&await r({...o,value:{...o.value,kind:"PAGE"}},{url:(0,h.getRequestMeta)(a,"initURL")}))return null;if(p&&as)throw Object.defineProperty(Error("Invariant: postponed state should not be present on a resume request"),"__NEXT_ERROR_CODE",{value:"E396",enumerable:!1,configurable:!0});if(q.headers){let a={...q.headers};for(let[c,d]of(M&&ai||delete a[x.NEXT_CACHE_TAGS_HEADER],Object.entries(a)))if(void 0!==d)if(Array.isArray(d))for(let a of d)b.appendHeader(c,a);else"number"==typeof d&&(d=d.toString()),b.appendHeader(c,d)}let t=null==(i=q.headers)?void 0:i[x.NEXT_CACHE_TAGS_HEADER];if(M&&ai&&t&&"string"==typeof t&&b.setHeader(x.NEXT_CACHE_TAGS_HEADER,t),!q.status||an&&ap||(b.statusCode=q.status),!M&&q.status&&E.RedirectStatusCode[q.status]&&an&&(b.statusCode=200),p&&b.setHeader(s.NEXT_DID_POSTPONE_HEADER,"1"),an&&!$){if(void 0===q.rscData){if(q.postponed)throw Object.defineProperty(Error("Invariant: Expected postponed to be undefined"),"__NEXT_ERROR_CODE",{value:"E372",enumerable:!1,configurable:!0});return(0,z.sendRenderResult)({req:a,res:b,type:"rsc",generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:q.html,cacheControl:at?{revalidate:0,expire:void 0}:o.cacheControl})}return(0,z.sendRenderResult)({req:a,res:b,type:"rsc",generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:w.default.fromStatic(q.rscData),cacheControl:o.cacheControl})}let v=q.html;if(!p||M)return(0,z.sendRenderResult)({req:a,res:b,type:"html",generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:v,cacheControl:o.cacheControl});if(aq)return v.chain(new ReadableStream({start(a){a.enqueue(y.ENCODED_TAGS.CLOSED.BODY_AND_HTML),a.close()}})),(0,z.sendRenderResult)({req:a,res:b,type:"html",generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:v,cacheControl:{revalidate:0,expire:void 0}});let A=new TransformStream;return v.chain(A.readable),f({span:d,postponed:q.postponed,fallbackRouteParams:null}).then(async a=>{var b,c;if(!a)throw Object.defineProperty(Error("Invariant: expected a result to be returned"),"__NEXT_ERROR_CODE",{value:"E463",enumerable:!1,configurable:!0});if((null==(b=a.value)?void 0:b.kind)!==u.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant: expected a page response, got ${null==(c=a.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E305",enumerable:!1,configurable:!0});await a.value.html.pipeTo(A.writable)}).catch(a=>{A.writable.abort(a).catch(a=>{console.error("couldn't abort transformer",a)})}),(0,z.sendRenderResult)({req:a,res:b,type:"html",generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:v,cacheControl:{revalidate:0,expire:void 0}})};if(!aD)return await aC.withPropagatedContext(a.headers,()=>aC.trace(i.BaseServerSpan.handleRequest,{spanName:`${aB} ${a.url}`,kind:g.SpanKind.SERVER,attributes:{"http.method":aB,"http.target":a.url}},n));await n(aD)}catch(b){throw aD||b instanceof A.NoFallbackError||await J.onRequestError(a,b,{routerKind:"App Router",routePath:B,routeType:"render",revalidateReason:(0,f.c)({isRevalidate:ai,isOnDemandRevalidate:af})},ab),b}}},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:a=>{"use strict";a.exports=require("zlib")},79551:a=>{"use strict";a.exports=require("url")},81630:a=>{"use strict";a.exports=require("http")},82410:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>aE});var d=c(60687),e=c(72641),f=c(70640),g=c(29523),h=c(35950),i=c(27741),j=c(97051),k=c(43210),l=c(96474),m=c(63503),n=c(24961),o=c(99270),p=c(89667),q=c(15079),r=c(44493),s=c(35768);let t=({filters:a,onFiltersChange:b,onClearFilters:c,isLoading:e=!1})=>{let{data:f}=(0,s.A$)({isActive:!0,limit:100}),h=(c,d)=>{b({...a,[c]:d})},i=Object.values(a).some(a=>void 0!==a&&""!==a&&null!==a&&"all"!==a);return(0,d.jsx)(r.Zp,{children:(0,d.jsx)(r.Wu,{className:"space-y-4",children:(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,d.jsx)("div",{children:(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)(o.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,d.jsx)(p.p,{placeholder:"Buscar contratos...",value:a.search||"",onChange:a=>h("search",a.target.value),className:"pl-10",disabled:e})]})}),(0,d.jsx)("div",{children:(0,d.jsxs)(q.l6,{value:a.serviceId||"all",onValueChange:a=>{"all"===a?h("serviceId",void 0):h("serviceId",a)},disabled:e,children:[(0,d.jsx)(q.bq,{children:(0,d.jsx)(q.yv,{placeholder:"Todos los servicios"})}),(0,d.jsxs)(q.gC,{children:[(0,d.jsx)(q.eb,{value:"all",children:"Todos los servicios"}),f?.data?.map(a=>(0,d.jsx)(q.eb,{value:a.id,children:a.name},a.id))]})]})}),(0,d.jsx)("div",{children:(0,d.jsxs)(q.l6,{value:a.sortBy||"createdAt",onValueChange:a=>h("sortBy",a),disabled:e,children:[(0,d.jsx)(q.bq,{children:(0,d.jsx)(q.yv,{placeholder:"Ordenar por"})}),(0,d.jsxs)(q.gC,{children:[(0,d.jsx)(q.eb,{value:"createdAt",children:"Fecha de creaci\xf3n"}),(0,d.jsx)(q.eb,{value:"updatedAt",children:"Fecha de actualizaci\xf3n"}),(0,d.jsx)(q.eb,{value:"startDate",children:"Fecha de inicio"}),(0,d.jsx)(q.eb,{value:"endDate",children:"Fecha de fin"})]})]})}),(0,d.jsx)("div",{children:i&&(0,d.jsx)(g.$,{variant:"outline",onClick:c,disabled:e,className:"w-full",children:"Limpiar Filtros"})})]})})})};var u=c(10022),v=c(23714),w=c(96834),x=c(88233);function y(a,b="PEN"){let c={PEN:{symbol:"S/",locale:"es-PE"},USD:{symbol:"$",locale:"en-US"}}[b];return`${c.symbol} ${a.toLocaleString(c.locale,{minimumFractionDigits:2,maximumFractionDigits:2})}`}var z=c(85763),A=c(13861),B=c(16023),C=c(58887),D=c(5336),E=c(11860),F=c(8693),G=c(54050),H=c(66666),I=c(29867);let J={all:["payments"],lists:()=>[...J.all,"list"],byInstallment:a=>[...J.lists(),"installment",a]};var K=c(19378),L=c(27605),M=c(63442),N=c(31692),O=c(71669),P=c(34729),Q=c(43649);let R=N.Ik({notes:N.Yj().min(10,"La nota debe tener al menos 10 caracteres").max(500,"La nota no puede exceder 500 caracteres")}),S=({open:a,onOpenChange:b,onConfirm:c,deliverableName:e,isLoading:f=!1})=>{let h=(0,L.mN)({resolver:(0,M.u)(R),defaultValues:{notes:""}});return(0,d.jsx)(m.lG,{open:a,onOpenChange:b,children:(0,d.jsxs)(m.Cf,{className:"sm:max-w-md",children:[(0,d.jsxs)(m.c7,{children:[(0,d.jsxs)(m.L3,{className:"flex items-center gap-2",children:[(0,d.jsx)(Q.A,{className:"h-5 w-5 text-destructive"}),"Rechazar Entregable"]}),(0,d.jsxs)(m.rr,{children:["Est\xe1s a punto de rechazar el entregable ",(0,d.jsx)("strong",{children:e}),". Por favor, proporciona una nota explicando el motivo del rechazo."]})]}),(0,d.jsx)(O.lV,{...h,children:(0,d.jsxs)("form",{onSubmit:h.handleSubmit(a=>{c(a.notes),h.reset()}),className:"space-y-4",children:[(0,d.jsx)(O.zB,{control:h.control,name:"notes",render:({field:a})=>(0,d.jsxs)(O.eI,{children:[(0,d.jsxs)(O.lR,{children:["Motivo del rechazo ",(0,d.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,d.jsx)(O.MJ,{children:(0,d.jsx)(P.T,{placeholder:"Describe detalladamente por qu\xe9 se rechaza este entregable...",className:"min-h-[100px] resize-none",...a})}),(0,d.jsx)(O.C5,{}),(0,d.jsxs)("div",{className:"text-xs text-muted-foreground",children:[a.value?.length||0,"/500 caracteres"]})]})}),(0,d.jsxs)(m.Es,{className:"gap-2",children:[(0,d.jsx)(g.$,{type:"button",variant:"outline",onClick:()=>{h.reset(),b(!1)},disabled:f,children:"Cancelar"}),(0,d.jsx)(g.$,{type:"submit",variant:"destructive",disabled:f,children:f?"Rechazando...":"Rechazar Entregable"})]})]})})]})})};var T=function(a){return a.CASH="CASH",a.BANK_TRANSFER="BANK_TRANSFER",a.CARD="CARD",a.YAPE="YAPE",a.PLIN="PLIN",a.OTHER="OTHER",a}({});let U=N.Ik({amount:N.ai().min(.01,"El monto debe ser mayor a 0"),currency:N.k5(["PEN","USD"],{message:"Selecciona una moneda v\xe1lida"}),method:N.fc(T,{message:"Selecciona un m\xe9todo de pago"}),reference:N.Yj().optional()}),V={[T.CASH]:"Efectivo",[T.BANK_TRANSFER]:"Transferencia Bancaria",[T.CARD]:"Tarjeta",[T.YAPE]:"Yape",[T.PLIN]:"Plin",[T.OTHER]:"Otro"},W=[{value:"PEN",label:"PEN - Soles"},{value:"USD",label:"USD - D\xf3lares"}];function X({open:a,onOpenChange:b,installmentId:c}){let e=(()=>{let a=(0,F.useQueryClient)(),{showSuccess:b,showError:c}=(0,I.d)();return(0,G.useMutation)({mutationFn:a=>H.M.createPayment(a),onSuccess:async(c,d)=>(await a.invalidateQueries({queryKey:J.byInstallment(d.installmentId)}),await a.invalidateQueries({queryKey:J.all}),await a.invalidateQueries({queryKey:["contracts"]}),b("created",{title:"Pago enviado",description:"El pago ha sido enviado para verificaci\xf3n exitosamente"}),c),onError:a=>{c("error",{title:"Error al enviar pago",description:a?.message||"No se pudo enviar el pago para verificaci\xf3n"})}})})(),f=(0,L.mN)({resolver:(0,M.u)(U),defaultValues:{amount:0,currency:"PEN",method:T.BANK_TRANSFER,reference:""}}),h=async a=>{if(!c)return void console.error("No se ha seleccionado una cuota");try{await e.mutateAsync({installmentId:c,...a}),b(!1),f.reset()}catch(a){console.error("Error al crear pago:",a)}},i=()=>{b(!1),f.reset()};return(0,d.jsx)(m.lG,{open:a,onOpenChange:i,children:(0,d.jsxs)(m.Cf,{className:"sm:max-w-[500px] max-h-[90vh] overflow-y-auto",children:[(0,d.jsxs)(m.c7,{children:[(0,d.jsx)(m.L3,{children:"Subir Pago"}),(0,d.jsx)(m.rr,{children:"Registra tu pago para esta cuota. La informaci\xf3n ser\xe1 verificada por el equipo administrativo."})]}),(0,d.jsx)(O.lV,{...f,children:(0,d.jsxs)("form",{onSubmit:f.handleSubmit(h),className:"space-y-4",children:[(0,d.jsx)(O.zB,{control:f.control,name:"amount",render:({field:a})=>(0,d.jsxs)(O.eI,{children:[(0,d.jsx)(O.lR,{children:"Monto"}),(0,d.jsx)(O.MJ,{children:(0,d.jsx)(p.p,{type:"number",step:"0.01",placeholder:"0.00",...a,onChange:b=>a.onChange(Number(b.target.value))})}),(0,d.jsx)(O.C5,{})]})}),(0,d.jsx)(O.zB,{control:f.control,name:"currency",render:({field:a})=>(0,d.jsxs)(O.eI,{children:[(0,d.jsx)(O.lR,{children:"Moneda"}),(0,d.jsxs)(q.l6,{onValueChange:a.onChange,defaultValue:a.value,children:[(0,d.jsx)(O.MJ,{children:(0,d.jsx)(q.bq,{children:(0,d.jsx)(q.yv,{placeholder:"Selecciona una moneda"})})}),(0,d.jsx)(q.gC,{children:W.map(a=>(0,d.jsx)(q.eb,{value:a.value,children:a.label},a.value))})]}),(0,d.jsx)(O.C5,{})]})}),(0,d.jsx)(O.zB,{control:f.control,name:"method",render:({field:a})=>(0,d.jsxs)(O.eI,{children:[(0,d.jsx)(O.lR,{children:"M\xe9todo de Pago"}),(0,d.jsxs)(q.l6,{onValueChange:a.onChange,defaultValue:a.value,children:[(0,d.jsx)(O.MJ,{children:(0,d.jsx)(q.bq,{children:(0,d.jsx)(q.yv,{placeholder:"Selecciona un m\xe9todo"})})}),(0,d.jsx)(q.gC,{children:Object.entries(V).map(([a,b])=>(0,d.jsx)(q.eb,{value:a,children:b},a))})]}),(0,d.jsx)(O.C5,{})]})}),(0,d.jsx)(O.zB,{control:f.control,name:"reference",render:({field:a})=>(0,d.jsxs)(O.eI,{children:[(0,d.jsx)(O.lR,{children:"N\xfamero de Operaci\xf3n (Opcional)"}),(0,d.jsx)(O.MJ,{children:(0,d.jsx)(p.p,{placeholder:"Ingresa el n\xfamero de operaci\xf3n",...a})}),(0,d.jsx)(O.C5,{})]})}),(0,d.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,d.jsx)(g.$,{type:"button",variant:"outline",onClick:i,disabled:e.isPending,children:"Cancelar"}),(0,d.jsx)(g.$,{type:"submit",disabled:e.isPending,children:e.isPending?"Enviando...":"Enviar Pago"})]})]})})]})})}let Y=({contract:a})=>{let[b,c]=(0,k.useState)("general"),[e,f]=(0,k.useState)({open:!1,payments:[],description:"",isCollaboratorPayment:!1}),[h,i]=(0,k.useState)({open:!1,contractId:"",deliverableId:"",deliverableName:""}),[j,l]=(0,k.useState)({open:!1,contractId:"",installmentId:""}),m=(0,n.k6)();(0,k.useEffect)(()=>{f({open:!1,payments:[],description:"",isCollaboratorPayment:!1}),i({open:!1,contractId:"",deliverableId:"",deliverableName:""}),l({open:!1,contractId:"",installmentId:""})},[a.id]);let o=a=>new Date(a).toLocaleDateString("es-PE",{day:"2-digit",month:"2-digit",year:"numeric"}),p=(a,b,c=!1)=>{f({open:!0,payments:a,description:b,isCollaboratorPayment:c})},q=async(a,b)=>{try{await m.mutateAsync({contractId:a,deliverableId:b,data:{isAproved:!0}})}catch(a){console.error("Error al verificar entregable:",a)}},s=async a=>{try{await m.mutateAsync({contractId:h.contractId,deliverableId:h.deliverableId,data:{isCompleted:!1,isAproved:!1,notes:a}}),i({open:!1,contractId:"",deliverableId:"",deliverableName:""})}catch(a){console.error("Error al rechazar entregable:",a)}},t=()=>a.contractUsers?.some(a=>"COLLABORATOR_EXTERNAL"===a.user.role)||!1,u=b=>{l({open:!0,contractId:a.id,installmentId:b})};return(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)(z.tU,{value:b,onValueChange:c,className:"w-full",children:[(0,d.jsxs)(z.j7,{className:"grid w-full grid-cols-3",children:[(0,d.jsx)(z.Xi,{value:"general",children:"Informaci\xf3n General"}),(0,d.jsx)(z.Xi,{value:"payments",children:"Pagos y Cuotas"}),(0,d.jsx)(z.Xi,{value:"deliverables",children:"Entregables"})]}),(0,d.jsx)(z.av,{value:"general",className:"space-y-4",children:(0,d.jsxs)(r.Zp,{children:[(0,d.jsx)(r.aR,{children:(0,d.jsx)(r.ZB,{children:"Informaci\xf3n del Contrato"})}),(0,d.jsxs)(r.Wu,{children:[(0,d.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Nombre del Proyecto"}),(0,d.jsx)("p",{className:"text-base font-medium mt-1",children:a.name})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Universidad"}),(0,d.jsx)("p",{className:"text-base mt-1",children:a.university})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Carrera"}),(0,d.jsx)("p",{className:"text-base mt-1",children:a.career})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Costo Total"}),(0,d.jsx)("p",{className:"text-lg font-semibold text-primary mt-1",children:y(a.costTotal,a.currency)})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Fecha de Inicio"}),(0,d.jsx)("p",{className:"text-base mt-1",children:o(a.startDate)})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Fecha de Finalizaci\xf3n"}),(0,d.jsx)("p",{className:"text-base mt-1",children:o(a.endDate)})]})]}),(0,d.jsxs)("div",{className:"mt-6 pt-4 border-t space-y-4",children:[(0,d.jsx)("h4",{className:"font-semibold",children:"Progreso del Proyecto"}),(0,d.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,d.jsx)("span",{className:"text-sm font-medium",children:"General"}),(0,d.jsxs)("span",{className:"text-sm font-semibold",children:[a.overallProgress,"%"]})]}),(0,d.jsx)("div",{className:"w-full bg-secondary rounded-full h-2",children:(0,d.jsx)("div",{className:"bg-primary h-2 rounded-full transition-all duration-300",style:{width:`${a.overallProgress}%`}})})]}),(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,d.jsx)("span",{className:"text-sm font-medium",children:"Entregables"}),(0,d.jsxs)("span",{className:"text-sm font-semibold",children:[a.deliverablesPercentage,"%"]})]}),(0,d.jsx)("div",{className:"w-full bg-secondary rounded-full h-2",children:(0,d.jsx)("div",{className:"bg-primary h-2 rounded-full transition-all duration-300",style:{width:`${a.deliverablesPercentage}%`}})})]}),(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,d.jsx)("span",{className:"text-sm font-medium",children:"Pagos"}),(0,d.jsxs)("span",{className:"text-sm font-semibold",children:[a.paymentPercentage,"%"]})]}),(0,d.jsx)("div",{className:"w-full bg-secondary rounded-full h-2",children:(0,d.jsx)("div",{className:"bg-primary h-2 rounded-full transition-all duration-300",style:{width:`${a.paymentPercentage}%`}})})]})]})]}),(0,d.jsxs)("div",{className:"mt-6 pt-4 border-t space-y-4",children:[(0,d.jsx)("h4",{className:"font-semibold",children:"Equipo del Proyecto"}),(0,d.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h5",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Colaborador Asignado"}),(0,d.jsx)("div",{className:"space-y-2",children:a.contractUsers&&a.contractUsers.length>0?a.contractUsers.filter(a=>"COLLABORATOR_INTERNAL"===a.user.role||"COLLABORATOR_EXTERNAL"===a.user.role).map(a=>(0,d.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-muted/50 rounded-lg",children:[(0,d.jsx)("div",{className:"h-8 w-8 bg-primary/10 rounded-full flex items-center justify-center",children:(0,d.jsxs)("span",{className:"text-sm font-medium text-primary",children:[a.user.profile.firstName.charAt(0),a.user.profile.lastName.charAt(0)]})}),(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsxs)("p",{className:"text-sm font-medium",children:[a.user.profile.firstName," ",a.user.profile.lastName]}),(0,d.jsx)("p",{className:"text-xs text-muted-foreground",children:"COLLABORATOR_INTERNAL"===a.user.role?"Colaborador Interno":"Colaborador Externo"})]}),(0,d.jsx)(w.E,{variant:"outline",className:"text-xs",children:a.user.profile.career})]},a.id)):(0,d.jsx)("p",{className:"text-sm text-muted-foreground",children:"No hay colaboradores asignados"})})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("h5",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Clientes de Investigaci\xf3n"}),(0,d.jsx)("div",{className:"space-y-2",children:a.contractUsers&&a.contractUsers.length>0?a.contractUsers.filter(a=>"CLIENT"===a.user.role).map(a=>(0,d.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-muted/50 rounded-lg",children:[(0,d.jsx)("div",{className:"h-8 w-8 bg-blue-500/10 rounded-full flex items-center justify-center",children:(0,d.jsxs)("span",{className:"text-sm font-medium text-blue-600",children:[a.user.profile.firstName.charAt(0),a.user.profile.lastName.charAt(0)]})}),(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsxs)("p",{className:"text-sm font-medium",children:[a.user.profile.firstName," ",a.user.profile.lastName]}),(0,d.jsx)("p",{className:"text-xs text-muted-foreground",children:a.user.profile.university})]}),(0,d.jsx)(w.E,{variant:"outline",className:"text-xs",children:"Cliente"})]},a.id)):(0,d.jsx)("p",{className:"text-sm text-muted-foreground",children:"No hay clientes asignados"})})]})]})]}),a.observation&&(0,d.jsxs)("div",{className:"mt-6 pt-4 border-t",children:[(0,d.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Observaciones"}),(0,d.jsx)("div",{className:"mt-2 p-3 bg-muted/50 rounded border-l-4 border-l-primary",children:(0,d.jsx)("p",{className:"text-sm",children:a.observation})})]})]})]})}),(0,d.jsxs)(z.av,{value:"payments",className:"space-y-4",children:[(0,d.jsxs)(r.Zp,{children:[(0,d.jsx)(r.aR,{children:(0,d.jsxs)(r.ZB,{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{children:"Cuotas de Pago del Contrato"}),(0,d.jsxs)(w.E,{variant:"secondary",children:[a.installments?.length||0," cuotas"]})]})}),(0,d.jsx)(r.Wu,{children:a.installments&&0!==a.installments.length?(0,d.jsx)("div",{className:"space-y-3",children:a.installments.map((b,c)=>{let e=b.payments?.reduce((a,b)=>"COMPLETED"===b.status?a+(b.amount||0):a,0)||0,f=e>=b.amount,h=b.payments&&b.payments.length>0,i=b.payments?.some(a=>"PENDING"===a.status)||!1;return(0,d.jsx)(r.Zp,{className:`${f?"border-l-4 border-l-primary":"border-l-4 border-l-muted-foreground"}`,children:(0,d.jsx)(r.Wu,{children:(0,d.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsx)("div",{className:`h-8 w-8 rounded-full flex items-center justify-center text-sm font-semibold ${f?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"}`,children:c+1}),(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsx)("div",{className:"font-medium truncate",children:b.description}),(0,d.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,d.jsxs)("span",{className:"block sm:inline",children:["Vence: ",o(b.dueDate)]}),(0,d.jsx)("span",{className:"hidden sm:inline",children:" • "}),(0,d.jsx)("span",{className:"block sm:inline",children:y(b.amount,a.currency)})]}),f&&(0,d.jsxs)("div",{className:"text-sm text-primary font-medium",children:["Pagado: ",y(e,a.currency)]}),i&&!f&&(0,d.jsx)("div",{className:"text-sm text-yellow-600 font-medium",children:"En verificaci\xf3n"})]})]}),(0,d.jsxs)("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-3",children:[(0,d.jsx)(w.E,{variant:f?"default":i?"outline":"secondary",className:`self-start sm:self-center ${i&&!f?"border-yellow-500 text-yellow-600":""}`,children:f?"Pagado":i?"En Verificaci\xf3n":"Pendiente"}),(0,d.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,d.jsxs)(g.$,{size:"sm",variant:"outline",disabled:!h,onClick:()=>p(b.payments||[],b.description,!1),className:"gap-2 w-full sm:w-auto text-xs",children:[(0,d.jsx)(A.A,{className:"h-3 w-3"}),(0,d.jsx)("span",{className:"sm:inline",children:"Ver Pagos"})]}),t()&&(0,d.jsxs)(g.$,{size:"sm",disabled:f,onClick:()=>u(b.id),className:"gap-2 w-full sm:w-auto",children:[(0,d.jsx)(B.A,{className:"h-4 w-4"}),(0,d.jsx)("span",{className:"sm:inline",children:"Subir Pago"})]})]})]})]})})},b.id)})}):(0,d.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:(0,d.jsx)("p",{children:"No hay cuotas de pago registradas para este contrato."})})})]}),t()&&(0,d.jsxs)(r.Zp,{children:[(0,d.jsx)(r.aR,{children:(0,d.jsxs)(r.ZB,{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{children:"Cuota de Pago al Colaborador"}),(0,d.jsxs)(w.E,{variant:"secondary",children:[a.contractUsers?.reduce((a,b)=>a+(b.installments?.length||0),0)||0," pagos"]})]})}),(0,d.jsx)(r.Wu,{children:a.contractUsers?.some(a=>a.installments&&a.installments.length>0)?(0,d.jsx)("div",{className:"space-y-4",children:a.contractUsers.filter(a=>"COLLABORATOR_EXTERNAL"===a.user.role&&a.installments&&a.installments.length>0).map(b=>(0,d.jsxs)("div",{className:"space-y-3",children:[(0,d.jsxs)("div",{className:"flex items-center gap-3 pb-2 border-b",children:[(0,d.jsx)("div",{className:"h-8 w-8 bg-blue-500/10 rounded-full flex items-center justify-center",children:(0,d.jsxs)("span",{className:"text-sm font-medium text-blue-600",children:[b.user.profile.firstName.charAt(0),b.user.profile.lastName.charAt(0)]})}),(0,d.jsxs)("div",{children:[(0,d.jsxs)("p",{className:"text-sm font-medium",children:[b.user.profile.firstName," ",b.user.profile.lastName]}),(0,d.jsx)("p",{className:"text-xs text-muted-foreground",children:"Colaborador Externo"})]})]}),b.installments?.map((c,e)=>{let f=(c.payments?.reduce((a,b)=>"COMPLETED"===b.status?a+(b.amount||0):a,0)||0)>=c.amount,h=c.payments&&c.payments.length>0,i=c.payments?.some(a=>"PENDING"===a.status)||!1;return(0,d.jsx)(r.Zp,{className:`ml-4 ${f?"border-l-4 border-l-primary":"border-l-4 border-l-muted-foreground"}`,children:(0,d.jsx)(r.Wu,{children:(0,d.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsx)("div",{className:`h-6 w-6 rounded-full flex items-center justify-center text-xs font-semibold ${f?"bg-blue-500 text-white":"bg-muted text-muted-foreground"}`,children:e+1}),(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsx)("div",{className:"font-medium truncate text-sm",children:c.description}),(0,d.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,d.jsxs)("span",{className:"block sm:inline",children:["Vence: ",o(c.dueDate)]}),(0,d.jsx)("span",{className:"hidden sm:inline",children:" • "}),(0,d.jsx)("span",{className:"block sm:inline",children:y(c.amount,a.currency)})]})]})]}),(0,d.jsxs)("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-3",children:[(0,d.jsx)(w.E,{variant:f?"default":i?"outline":"secondary",className:`self-start sm:self-center text-xs ${f?"bg-blue-700":""} ${i&&!f?"border-yellow-500 text-yellow-600":""}`,children:f?"Pagado":i?"En Verificaci\xf3n":"Pendiente"}),(0,d.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,d.jsxs)(g.$,{size:"sm",variant:"outline",disabled:!h,onClick:()=>p(c.payments||[],`Pago colaborador - ${b.user.profile.firstName}`,!0),className:"gap-2 w-full sm:w-auto text-xs",children:[(0,d.jsx)(A.A,{className:"h-3 w-3"}),(0,d.jsx)("span",{className:"sm:inline",children:"Ver Pagos"})]}),(0,d.jsxs)(g.$,{size:"sm",disabled:f,onClick:()=>u(c.id),className:"gap-2 w-full sm:w-auto",children:[(0,d.jsx)(B.A,{className:"h-3 w-3"}),(0,d.jsx)("span",{className:"sm:inline",children:"Subir Pago"})]})]})]})]})})},c.id)})]},b.id))}):(0,d.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:(0,d.jsx)("p",{children:"No hay pagos de colaboradores registrados para este contrato."})})})]})]}),(0,d.jsx)(z.av,{value:"deliverables",className:"space-y-6",children:(0,d.jsxs)(r.Zp,{children:[(0,d.jsx)(r.aR,{children:(0,d.jsxs)(r.ZB,{className:"flex items-center gap-3",children:[(0,d.jsx)("span",{children:"Entregables del Proyecto"}),(0,d.jsxs)(w.E,{variant:"secondary",className:"ml-auto",children:[a.contractDeliverables?.length||0," entregables"]})]})}),(0,d.jsx)(r.Wu,{children:a.contractDeliverables&&0!==a.contractDeliverables.length?(0,d.jsx)("div",{className:"space-y-3",children:a.contractDeliverables.map((b,c)=>{let e=b.isCompleted&&!b.isAproved,f=b.isAproved,h=b.isCompleted;return(0,d.jsx)(r.Zp,{className:`${f?"border-l-4 border-l-green-500/50":h?"border-l-4 border-l-primary":"border-l-4 border-l-muted-foreground"}`,children:(0,d.jsx)(r.Wu,{children:(0,d.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,d.jsxs)("div",{className:"flex items-start gap-3",children:[(0,d.jsx)("div",{className:`h-8 w-8 rounded-full flex items-center justify-center text-sm font-semibold flex-shrink-0 ${f?"bg-green-100 dark:bg-green-900/20 text-green-800 dark:text-green-300":h?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"}`,children:c+1}),(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsx)("div",{className:"font-medium truncate",children:b.deliverable?.name||`Entregable #${c+1}`}),(0,d.jsx)("div",{className:"text-sm text-muted-foreground",children:b.deliverable?.description||"Sin descripci\xf3n"}),(0,d.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Asignado: ",o(b.assignedAt)]}),b.completedAt&&(0,d.jsxs)("div",{className:"text-sm text-primary font-medium",children:["Completado: ",o(b.completedAt)]}),b.notes&&(0,d.jsxs)("div",{className:"mt-2 p-2 rounded-md bg-primary/10 dark:bg-primary/20 border border-primary/20 dark:border-primary/30 flex items-start gap-2",children:[(0,d.jsx)(C.A,{className:"h-4 w-4 text-primary shrink-0"}),(0,d.jsxs)("div",{className:"text-xs break-words",children:[(0,d.jsx)("span",{className:"font-semibold text-primary",children:"Observaci\xf3n: "}),(0,d.jsx)("span",{className:"text-muted-foreground",children:b.notes})]})]})]})]}),(0,d.jsxs)("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3",children:[(0,d.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,d.jsx)(w.E,{variant:h?"default":"secondary",className:"w-fit",children:h?"Completado":"En Progreso"}),f&&(0,d.jsx)(w.E,{variant:"default",className:"bg-green-100 dark:bg-green-900/20 text-green-800 dark:text-green-300 w-fit",children:"Aprobado"})]}),(0,d.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,d.jsxs)(g.$,{size:"sm",variant:e?"default":"outline",disabled:!e||m.isPending,onClick:()=>q(a.id,b.deliverableId),className:"gap-2 w-full sm:w-auto",children:[(0,d.jsx)(D.A,{className:"h-4 w-4"}),(0,d.jsx)("span",{className:"sm:inline",children:m.isPending?"Verificando...":e?"Aprobar":f?"Aprobado":"No Disponible"})]}),(0,d.jsxs)(g.$,{size:"sm",variant:"destructive",disabled:!e||m.isPending,onClick:()=>{var d;return d=a.id,void i({open:!0,contractId:d,deliverableId:b.deliverableId,deliverableName:b.deliverable?.name||`Entregable #${c+1}`})},className:"gap-2 w-full sm:w-auto",children:[(0,d.jsx)(E.A,{className:"h-4 w-4"}),(0,d.jsx)("span",{className:"sm:inline",children:m.isPending?"Procesando...":"Rechazar"})]})]})]})]})})},b.id)})}):(0,d.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:(0,d.jsx)("p",{children:"No hay entregables registrados para este contrato."})})})]})})]}),(0,d.jsx)(K.q,{open:e.open,onOpenChange:a=>f(b=>({...b,open:a})),payments:e.payments,installmentDescription:e.description,canManagePayments:!e.isCollaboratorPayment}),(0,d.jsx)(S,{open:h.open,onOpenChange:a=>i(b=>({...b,open:a})),onConfirm:s,deliverableName:h.deliverableName,isLoading:m.isPending}),(0,d.jsx)(X,{open:j.open,onOpenChange:a=>l(b=>({...b,open:a})),contractId:j.contractId,installmentId:j.installmentId})]})},Z=({data:a,isLoading:b=!1,onDelete:c,serverPagination:e=!1,paginationMeta:f,onPageChange:h,onPageSizeChange:i})=>{let[j,l]=(0,k.useState)(null),m=j&&a.find(a=>a.id===j)||null,n=(({onDelete:a}={})=>[{accessorKey:"name",header:"Nombre del Proyecto",cell:({row:a})=>{let b=a.original;return(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsx)("div",{className:"font-medium",children:b.name}),(0,d.jsx)("div",{className:"text-xs text-muted-foreground",children:b.university}),b.career&&(0,d.jsx)("div",{className:"text-xs text-muted-foreground",children:b.career})]})}},{accessorKey:"costTotal",header:"Costo Total",cell:({row:a})=>{let b=a.original;return(0,d.jsx)("div",{children:(0,d.jsx)("div",{className:"font-medium",children:y(b.costTotal,b.currency)})})}},{accessorKey:"overallProgress",header:"Progreso General",cell:({row:a})=>{let b=a.getValue("overallProgress");return(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsxs)("div",{className:"text-sm font-medium",children:[b,"%"]}),(0,d.jsx)("div",{className:"w-full bg-secondary rounded-full h-2",children:(0,d.jsx)("div",{className:"bg-primary h-2 rounded-full transition-all",style:{width:`${b}%`}})})]})}},{accessorKey:"deliverablesPercentage",header:"Entregables",cell:({row:a})=>{let b=a.getValue("deliverablesPercentage");return(0,d.jsxs)(w.E,{variant:100===b?"default":"secondary",children:[b,"%"]})}},{accessorKey:"paymentPercentage",header:"Pagos",cell:({row:a})=>{let b=a.getValue("paymentPercentage");return(0,d.jsxs)(w.E,{variant:100===b?"default":"destructive",children:[b,"%"]})}},{accessorKey:"startDate",header:"Fecha Inicio",cell:({row:a})=>{let b=new Date(a.getValue("startDate"));return(0,d.jsx)("div",{className:"text-sm",children:b.toLocaleDateString("es-PE",{year:"numeric",month:"short",day:"numeric"})})}},{accessorKey:"endDate",header:"Fecha Fin",cell:({row:a})=>{let b=new Date(a.getValue("endDate"));return(0,d.jsx)("div",{className:"text-sm",children:b.toLocaleDateString("es-PE",{year:"numeric",month:"short",day:"numeric"})})}},{id:"actions",header:"Acciones",cell:({row:b})=>{let c=b.original;return(0,d.jsx)("div",{className:"flex items-center gap-2",children:(0,d.jsx)(g.$,{size:"sm",variant:"outline",onClick:()=>a?.(c.id),className:"h-8 px-2 text-red-600 hover:text-red-700 hover:bg-red-50",children:(0,d.jsx)(x.A,{className:"h-4 w-4"})})})}}])({onDelete:c});return(0,d.jsx)(v.b,{data:a,columns:n,isLoading:b,title:"Contratos",icon:u.A,noDataMessage:"No se encontraron contratos registrados",enablePagination:!0,enableSorting:!0,pageSize:10,selectedItem:m,detailComponent:a=>(0,d.jsx)(Y,{contract:a}),detailTitle:a=>a.name,getItemId:a=>a.id,onRowClick:a=>{a?l(j===a.id?null:a.id):l(null)},serverPagination:e,paginationMeta:f,onPageChange:h,onPageSizeChange:i})};var $=c(25541),_=c(26426);let aa=({data:a,isLoading:b=!1})=>(0,d.jsxs)(_.M,{columns:3,children:[(0,d.jsx)(_.h,{title:"Total de Proyectos",value:a?.totalContracts||0,subtitle:`${a?.thisMonthContracts||0} nuevos este mes`,icon:u.A,loading:b}),(0,d.jsx)(_.h,{title:"Proyectos Activos",value:a?.activeContracts||0,subtitle:`${a?Math.round(a.activeContracts/(a.totalContracts||1)*100):0}% del total`,icon:$.A,variant:"success",loading:b}),(0,d.jsx)(_.h,{title:"Proyectos Completados",value:a?.completedContracts||0,subtitle:`${a?Math.round(a.completedContracts/(a.totalContracts||1)*100):0}% completados`,icon:D.A,variant:"default",loading:b})]});var ab=c(89038);let ac=({open:a,onOpenChange:b,onConfirm:c,contractName:e,isLoading:f=!1})=>(0,d.jsx)(ab.Lt,{open:a,onOpenChange:b,children:(0,d.jsxs)(ab.EO,{children:[(0,d.jsxs)(ab.wd,{children:[(0,d.jsx)(ab.r7,{children:"\xbfEliminar contrato?"}),(0,d.jsxs)(ab.$v,{children:["Esta acci\xf3n eliminar\xe1 permanentemente el contrato",e&&(0,d.jsxs)(d.Fragment,{children:[" ",(0,d.jsxs)("strong",{children:["“",e,"”"]})]})," ","y todos sus datos asociados. Esta acci\xf3n no se puede deshacer."]})]}),(0,d.jsxs)(ab.ck,{children:[(0,d.jsx)(ab.Zr,{disabled:f,children:"Cancelar"}),(0,d.jsx)(ab.Rx,{onClick:c,disabled:f,className:"bg-red-600 hover:bg-red-700 focus:ring-red-600",children:f?"Eliminando...":"Eliminar"})]})]})});var ad=c(17313),ae=c(40228),af=c(13964),ag=c(41312),ah=c(58869),ai=c(85778),aj=c(52136),ak=c(47814),al=c(48199),am=c(47215),an=c(34690),ao=c(30321);let ap=N.Ik({serviceId:N.Yj().min(1,"Debe seleccionar un servicio"),name:N.Yj().min(1,"El nombre del contrato es obligatorio").min(3,"El nombre debe tener al menos 3 caracteres").max(200,"El nombre no puede exceder 200 caracteres"),university:N.Yj().min(1,"La universidad es obligatoria").min(3,"La universidad debe tener al menos 3 caracteres"),career:N.Yj().min(1,"La carrera es obligatoria").min(3,"La carrera debe tener al menos 3 caracteres"),observation:N.Yj().optional(),collaboratorId:N.Yj().min(1,"Debe seleccionar un colaborador"),researchClientIds:N.YO(N.Yj()).min(1,"Debe seleccionar al menos un cliente").max(3,"M\xe1ximo 3 clientes permitidos")}),aq=({initialData:a,onNext:b})=>{let[c]=(0,k.useState)(""),[e,f]=(0,k.useState)(!1),[h,i]=(0,k.useState)(!1),j=(0,L.mN)({resolver:(0,M.u)(ap),defaultValues:{serviceId:a?.serviceId||"",name:a?.name||"",university:a?.university||"",career:a?.career||"",observation:a?.observation||"",collaboratorId:a?.collaboratorId||"",researchClientIds:a?.researchClientIds||[]}}),{data:m}=(0,s.A$)({isActive:!0,limit:100}),{data:n,refetch:o}=(0,aj.kp)({search:c.length>=2?c:void 0,isActive:!0,limit:100}),q=n?.data?.filter(a=>a.role===am.gG.COLLABORATOR_INTERNAL||a.role===am.gG.COLLABORATOR_EXTERNAL)||[],{data:t,refetch:u}=(0,al.r8)({limit:100}),v=m?.data?.map(a=>({value:a.id,label:a.name}))||[],w=q.map(a=>({value:a.id,label:`${a.profile.documentNumber} - ${a.profile.firstName} ${a.profile.lastName}`})),x=t?.data?.map(a=>({value:a.id,label:`${a.profile.documentNumber} - ${a.profile.firstName} ${a.profile.lastName}`}))||[],y=async()=>{f(!1),await o()},z=async()=>{i(!1),await u()};return(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)("h2",{className:"text-2xl font-bold",children:"Informaci\xf3n B\xe1sica del Contrato"}),(0,d.jsx)("p",{className:"text-muted-foreground",children:"Complete la informaci\xf3n general del contrato y seleccione los participantes"})]}),(0,d.jsx)(O.lV,{...j,children:(0,d.jsxs)("form",{onSubmit:j.handleSubmit(a=>{b(a)}),className:"space-y-6",children:[(0,d.jsxs)(r.Zp,{children:[(0,d.jsx)(r.aR,{children:(0,d.jsxs)(r.ZB,{className:"flex items-center gap-2",children:[(0,d.jsx)(ad.A,{className:"h-5 w-5"}),"Informaci\xf3n del Contrato"]})}),(0,d.jsxs)(r.Wu,{className:"space-y-4",children:[(0,d.jsx)(O.zB,{control:j.control,name:"serviceId",render:({field:a})=>(0,d.jsxs)(O.eI,{children:[(0,d.jsx)(O.lR,{children:"Servicio *"}),(0,d.jsx)(O.MJ,{children:(0,d.jsx)(ak.Zi,{options:v,value:a.value,onValueChange:a.onChange,placeholder:"Seleccionar servicio...",searchPlaceholder:"Buscar servicio...",emptyMessage:"No se encontraron servicios"})}),(0,d.jsx)(O.C5,{})]})}),(0,d.jsx)(O.zB,{control:j.control,name:"name",render:({field:a})=>(0,d.jsxs)(O.eI,{children:[(0,d.jsx)(O.lR,{children:"Nombre del Contrato *"}),(0,d.jsx)(O.MJ,{children:(0,d.jsx)(p.p,{placeholder:"Ej: Tesis de Ingenier\xeda de Sistemas - UNI",...a})}),(0,d.jsx)(O.C5,{})]})}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,d.jsx)(O.zB,{control:j.control,name:"university",render:({field:a})=>(0,d.jsxs)(O.eI,{children:[(0,d.jsx)(O.lR,{children:"Universidad *"}),(0,d.jsx)(O.MJ,{children:(0,d.jsx)(p.p,{placeholder:"Ej: Universidad Nacional de Ingenier\xeda",...a})}),(0,d.jsx)(O.C5,{})]})}),(0,d.jsx)(O.zB,{control:j.control,name:"career",render:({field:a})=>(0,d.jsxs)(O.eI,{children:[(0,d.jsx)(O.lR,{children:"Carrera *"}),(0,d.jsx)(O.MJ,{children:(0,d.jsx)(p.p,{placeholder:"Ej: Ingenier\xeda de Sistemas",...a})}),(0,d.jsx)(O.C5,{})]})})]}),(0,d.jsx)(O.zB,{control:j.control,name:"observation",render:({field:a})=>(0,d.jsxs)(O.eI,{children:[(0,d.jsx)(O.lR,{children:"Observaciones"}),(0,d.jsx)(O.MJ,{children:(0,d.jsx)(P.T,{placeholder:"Observaciones adicionales sobre el contrato...",rows:3,...a})}),(0,d.jsx)(O.C5,{})]})})]})]}),(0,d.jsxs)(r.Zp,{children:[(0,d.jsx)(r.aR,{children:(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)(r.ZB,{className:"flex items-center gap-2",children:[(0,d.jsx)(ah.A,{className:"h-5 w-5"}),"Colaborador Responsable"]}),(0,d.jsxs)(g.$,{type:"button",variant:"outline",size:"sm",onClick:()=>f(!0),className:"flex items-center gap-2",children:[(0,d.jsx)(l.A,{className:"h-4 w-4"}),"A\xf1adir Nuevo"]})]})}),(0,d.jsx)(r.Wu,{children:(0,d.jsx)(O.zB,{control:j.control,name:"collaboratorId",render:({field:a})=>(0,d.jsxs)(O.eI,{children:[(0,d.jsx)(O.lR,{children:"Colaborador *"}),(0,d.jsx)(O.MJ,{children:(0,d.jsx)(ak.Zi,{options:w,value:a.value,onValueChange:a.onChange,placeholder:"Seleccionar colaborador...",searchPlaceholder:"Buscar por nombre o DNI...",emptyMessage:"No se encontraron colaboradores"},`collaborators-${q.length}`)}),(0,d.jsx)(O.C5,{})]})})})]}),(0,d.jsxs)(r.Zp,{children:[(0,d.jsx)(r.aR,{children:(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)(r.ZB,{className:"flex items-center gap-2",children:[(0,d.jsx)(ag.A,{className:"h-5 w-5"}),"Clientes de Investigaci\xf3n"]}),(0,d.jsxs)(g.$,{type:"button",variant:"outline",size:"sm",onClick:()=>i(!0),className:"flex items-center gap-2",children:[(0,d.jsx)(l.A,{className:"h-4 w-4"}),"A\xf1adir Nuevo"]})]})}),(0,d.jsx)(r.Wu,{children:(0,d.jsx)(O.zB,{control:j.control,name:"researchClientIds",render:({field:a})=>(0,d.jsxs)(O.eI,{children:[(0,d.jsx)(O.lR,{children:"Clientes *"}),(0,d.jsx)(O.MJ,{children:(0,d.jsx)(ak.KF,{options:x,value:a.value,onValueChange:a.onChange,placeholder:"Seleccionar clientes...",searchPlaceholder:"Buscar por nombre o DNI...",emptyMessage:"No se encontraron clientes",maxSelections:3},`clients-${t?.data?.length||0}`)}),(0,d.jsx)(O.C5,{})]})})})]}),(0,d.jsx)("div",{className:"flex justify-end",children:(0,d.jsx)("button",{type:"submit",className:"px-6 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors",children:"Siguiente: Entregables"})})]})}),(0,d.jsx)(an.q,{open:e,onOpenChange:f,onUserSaved:y,mode:"create"}),(0,d.jsx)(ao.Z,{open:h,onOpenChange:i,onClientSaved:z,mode:"create"})]})};var ar=c(62688);let as=(0,ar.A)("square-check-big",[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),at=(0,ar.A)("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);var au=c(56896);let av=N.Ik({deliverableIds:N.YO(N.Yj()).min(1,"Debe seleccionar al menos un entregable")}),aw=({serviceId:a,initialData:b,onNext:c,onBack:e})=>{let f=(0,L.mN)({resolver:(0,M.u)(av),defaultValues:{deliverableIds:b?.deliverableIds||[]}}),{data:h,isLoading:i}=(0,s.EQ)(a),j=f.watch("deliverableIds"),l=(0,k.useMemo)(()=>h?.data||[],[h?.data]),m=(0,k.useCallback)(a=>{let b,c=f.getValues("deliverableIds");b=c.includes(a)?c.filter(b=>b!==a):[...c,a],f.setValue("deliverableIds",b)},[f]),n=(0,k.useCallback)(()=>{let a=l.map(a=>a.id);a.every(a=>j.includes(a))?f.setValue("deliverableIds",[]):f.setValue("deliverableIds",a)},[l,j,f]),o=l.length>0&&l.every(a=>j.includes(a.id));return i?(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)("h2",{className:"text-2xl font-bold",children:"Entregables del Contrato"}),(0,d.jsx)("p",{className:"text-muted-foreground",children:"Cargando entregables..."})]}),(0,d.jsx)(r.Zp,{children:(0,d.jsx)(r.Wu,{className:"p-8",children:(0,d.jsx)("div",{className:"flex items-center justify-center",children:(0,d.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})})})]}):(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)("h2",{className:"text-2xl font-bold",children:"Entregables del Contrato"}),(0,d.jsx)("p",{className:"text-muted-foreground",children:"Seleccione los entregables que formar\xe1n parte de este contrato"})]}),(0,d.jsx)(O.lV,{...f,children:(0,d.jsxs)("form",{onSubmit:f.handleSubmit(a=>{c(a)}),className:"space-y-6",children:[(0,d.jsxs)(r.Zp,{children:[(0,d.jsx)(r.aR,{children:(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)(r.ZB,{className:"flex items-center gap-2",children:[(0,d.jsx)(u.A,{className:"h-5 w-5"}),"Entregables Disponibles",j.length>0&&(0,d.jsxs)(w.E,{variant:"secondary",children:[j.length," seleccionados"]})]}),l.length>0&&(0,d.jsx)(g.$,{type:"button",variant:"outline",size:"sm",onClick:n,className:"flex items-center gap-2",children:o?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(as,{className:"h-4 w-4"}),"Deseleccionar Todo"]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(at,{className:"h-4 w-4"}),"Seleccionar Todo"]})})]})}),(0,d.jsx)(r.Wu,{children:(0,d.jsx)(O.zB,{control:f.control,name:"deliverableIds",render:()=>(0,d.jsxs)(O.eI,{children:[(0,d.jsx)(O.lR,{className:"sr-only",children:"Entregables"}),(0,d.jsx)(O.MJ,{children:(0,d.jsx)("div",{className:"space-y-3",children:0===l.length?(0,d.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,d.jsx)(u.A,{className:"mx-auto h-12 w-12 opacity-50 mb-4"}),(0,d.jsx)("p",{children:"No hay entregables disponibles para este servicio"}),(0,d.jsx)("p",{className:"text-sm",children:"Contacte al administrador para agregar entregables"})]}):l.map(a=>{let b=j.includes(a.id);return(0,d.jsxs)("div",{className:`flex items-start space-x-3 p-4 border rounded-lg transition-colors cursor-pointer hover:bg-muted/50 ${b?"bg-primary/5 border-primary/30":"bg-background border-border"}`,onClick:b=>{b.preventDefault(),m(a.id)},children:[(0,d.jsx)("div",{onClick:a=>a.stopPropagation(),children:(0,d.jsx)(au.S,{checked:b,onCheckedChange:()=>m(a.id),className:"mt-1"})}),(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,d.jsx)("h4",{className:"font-medium",children:a.name}),(0,d.jsx)(w.E,{variant:"outline",className:"text-xs",children:"Entregable"})]}),a.description&&(0,d.jsx)("p",{className:"text-sm text-muted-foreground",children:a.description}),(0,d.jsxs)("div",{className:"flex items-center gap-4 mt-2 text-xs text-muted-foreground",children:[(0,d.jsxs)("span",{children:["Creado: ",new Date(a.createdAt).toLocaleDateString()]}),(0,d.jsxs)("span",{children:["Estado: ",a.isActive?"Activo":"Inactivo"]})]})]})]},a.id)})})}),(0,d.jsx)(O.C5,{})]})})})]}),(0,d.jsxs)("div",{className:"flex justify-between",children:[(0,d.jsx)(g.$,{type:"button",variant:"outline",onClick:e,children:"Anterior: Informaci\xf3n B\xe1sica"}),(0,d.jsx)(g.$,{type:"submit",disabled:0===j.length,children:"Siguiente: Fechas y Pagos"})]})]})})]})};var ax=c(23928);let ay=N.Ik({description:N.Yj().min(1,"La descripci\xf3n es obligatoria"),amount:N.ai().min(1,"El monto debe ser mayor a 0"),dueDate:N.p6()}),az=N.Ik({userId:N.Yj().min(1,"El ID del colaborador es obligatorio"),amount:N.ai().min(1,"El monto debe ser mayor a 0"),dueDate:N.p6(),description:N.Yj().min(1,"La descripci\xf3n es obligatoria")}),aA=N.Ik({costTotal:N.ai().min(1,"El costo total debe ser mayor a 0"),currency:N.k5(["PEN","USD"]),startDate:N.p6(),endDate:N.p6(),paymentType:N.k5(["cash","installments"]),installments:N.YO(ay).optional(),collaboratorPayments:N.YO(az).optional()}).refine(a=>!a.startDate||!a.endDate||a.startDate<a.endDate,{message:"La fecha de fin debe ser posterior a la fecha de inicio",path:["endDate"]}),aB=({initialData:a,onNext:b,onBack:c,collaboratorId:e,collaboratorRole:f,contractName:h})=>{let[i,j]=(0,k.useState)(a?.installments||[]),[m,n]=(0,k.useState)(a?.installments?.length||2),[o,s]=(0,k.useState)(a?.collaboratorPayments||[]),t="COLLABORATOR_EXTERNAL"===f,u=(0,L.mN)({resolver:(0,M.u)(aA),defaultValues:{costTotal:a?.costTotal||0,currency:a?.currency||"PEN",startDate:a?.startDate||new Date,endDate:a?.endDate||new Date(Date.now()+2592e6),paymentType:a?.paymentType||"cash",installments:i,collaboratorPayments:o}}),v=u.watch("paymentType"),y=u.watch("startDate"),z=u.watch("endDate"),A=u.watch("costTotal");(0,k.useEffect)(()=>{t&&e&&h&&z&&s(a=>{if(0===a.length){let a={userId:e,amount:0,dueDate:z,description:`Pago colaborador - ${h}`};return u.setValue("collaboratorPayments",[a]),[a]}{let b=a.map(a=>({...a,dueDate:z}));return u.setValue("collaboratorPayments",b),b}})},[t,e,h,z,u]);let B=(0,k.useCallback)(()=>{if("installments"===v&&y&&z&&A>0&&m>0){let a=Math.floor(A/m*100)/100,b=Math.round((A-a*m)*100)/100,c=[],d=Math.ceil(Math.ceil((z.getTime()-y.getTime())/864e5)/m);for(let e=0;e<m;e++){let f=new Date(y);f.setDate(f.getDate()+d*(e+1));let g=e===m-1?a+b:a;c.push({description:`Cuota ${e+1} de ${m}`,amount:g,dueDate:f})}j(c),u.setValue("installments",c)}},[v,y,z,A,m,u]);(0,k.useEffect)(()=>{B()},[B]),(0,k.useEffect)(()=>{"installments"===v&&0===i.length&&B()},[v,i.length,B]);let C=(a,b,c)=>{let d=[...i];d[a]={...d[a],[b]:c},j(d),u.setValue("installments",d)},D=(a,b,c)=>{let d=[...o];d[a]={...d[a],[b]:c},s(d),u.setValue("collaboratorPayments",d)},E=i.reduce((a,b)=>a+b.amount,0),F=A-E;return(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)("h2",{className:"text-2xl font-bold",children:"Fechas y Configuraci\xf3n de Pagos"}),(0,d.jsx)("p",{className:"text-muted-foreground",children:"Configure las fechas del proyecto y el esquema de pagos"})]}),(0,d.jsx)(O.lV,{...u,children:(0,d.jsxs)("form",{onSubmit:u.handleSubmit(a=>{"installments"===a.paymentType?a.installments=i:a.installments=[{description:"Pago \xfanico",amount:a.costTotal,dueDate:a.endDate}],t&&(a.collaboratorPayments=o),b(a)}),className:"space-y-6",children:[(0,d.jsxs)(r.Zp,{children:[(0,d.jsx)(r.aR,{children:(0,d.jsxs)(r.ZB,{className:"flex items-center gap-2",children:[(0,d.jsx)(ax.A,{className:"h-5 w-5"}),"Informaci\xf3n Financiera"]})}),(0,d.jsx)(r.Wu,{className:"space-y-4",children:(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,d.jsx)(O.zB,{control:u.control,name:"costTotal",render:({field:a})=>(0,d.jsxs)(O.eI,{children:[(0,d.jsx)(O.lR,{children:"Costo Total *"}),(0,d.jsx)(O.MJ,{children:(0,d.jsx)(p.p,{type:"number",placeholder:"0.00",...a,onChange:b=>a.onChange(Number(b.target.value))})}),(0,d.jsx)(O.C5,{})]})}),(0,d.jsx)(O.zB,{control:u.control,name:"currency",render:({field:a})=>(0,d.jsxs)(O.eI,{children:[(0,d.jsx)(O.lR,{children:"Moneda *"}),(0,d.jsxs)(q.l6,{onValueChange:a.onChange,defaultValue:a.value,children:[(0,d.jsx)(O.MJ,{children:(0,d.jsx)(q.bq,{children:(0,d.jsx)(q.yv,{placeholder:"Seleccionar moneda"})})}),(0,d.jsxs)(q.gC,{children:[(0,d.jsx)(q.eb,{value:"PEN",children:"Soles (PEN)"}),(0,d.jsx)(q.eb,{value:"USD",children:"D\xf3lares (USD)"})]})]}),(0,d.jsx)(O.C5,{})]})})]})})]}),(0,d.jsxs)(r.Zp,{children:[(0,d.jsx)(r.aR,{children:(0,d.jsxs)(r.ZB,{className:"flex items-center gap-2",children:[(0,d.jsx)(ae.A,{className:"h-5 w-5"}),"Fechas del Proyecto"]})}),(0,d.jsx)(r.Wu,{className:"space-y-4",children:(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,d.jsx)(O.zB,{control:u.control,name:"startDate",render:({field:a})=>(0,d.jsxs)(O.eI,{children:[(0,d.jsx)(O.lR,{children:"Fecha de Inicio *"}),(0,d.jsx)(O.MJ,{children:(0,d.jsx)(ak.J3,{value:a.value,onChange:a.onChange,placeholder:"Seleccionar fecha de inicio"})}),(0,d.jsx)(O.C5,{})]})}),(0,d.jsx)(O.zB,{control:u.control,name:"endDate",render:({field:a})=>(0,d.jsxs)(O.eI,{children:[(0,d.jsx)(O.lR,{children:"Fecha de Finalizaci\xf3n *"}),(0,d.jsx)(O.MJ,{children:(0,d.jsx)(ak.J3,{value:a.value,onChange:a.onChange,placeholder:"Seleccionar fecha de fin"})}),(0,d.jsx)(O.C5,{})]})})]})})]}),t&&(0,d.jsxs)(r.Zp,{children:[(0,d.jsx)(r.aR,{children:(0,d.jsxs)(r.ZB,{className:"flex items-center gap-2",children:[(0,d.jsx)(ah.A,{className:"h-5 w-5"}),"Pago de Colaborador Externo"]})}),(0,d.jsx)(r.Wu,{className:"space-y-4",children:o.map((a,b)=>(0,d.jsxs)("div",{className:"p-4 border rounded-lg space-y-4",children:[(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium",children:"Monto del Pago *"}),(0,d.jsx)(p.p,{type:"number",value:a.amount,onChange:a=>D(b,"amount",Number(a.target.value)),placeholder:"0.00"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium",children:"Fecha de Pago *"}),(0,d.jsx)(ak.J3,{value:a.dueDate,onChange:a=>D(b,"dueDate",a),placeholder:"Seleccionar fecha"})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium",children:"Descripci\xf3n *"}),(0,d.jsx)(p.p,{value:a.description,onChange:a=>D(b,"description",a.target.value),placeholder:"Descripci\xf3n del pago"})]})]},b))})]}),(0,d.jsxs)(r.Zp,{children:[(0,d.jsx)(r.aR,{children:(0,d.jsxs)(r.ZB,{className:"flex items-center gap-2",children:[(0,d.jsx)(ai.A,{className:"h-5 w-5"}),"Configuraci\xf3n de Pagos"]})}),(0,d.jsxs)(r.Wu,{className:"space-y-4",children:[(0,d.jsx)(O.zB,{control:u.control,name:"paymentType",render:({field:a})=>(0,d.jsxs)(O.eI,{children:[(0,d.jsx)(O.lR,{children:"Tipo de Pago *"}),(0,d.jsxs)(q.l6,{onValueChange:a.onChange,defaultValue:a.value,children:[(0,d.jsx)(O.MJ,{children:(0,d.jsx)(q.bq,{children:(0,d.jsx)(q.yv,{placeholder:"Seleccionar tipo de pago"})})}),(0,d.jsxs)(q.gC,{children:[(0,d.jsx)(q.eb,{value:"cash",children:"Pago al Contado"}),(0,d.jsx)(q.eb,{value:"installments",children:"Pago en Cuotas"})]})]}),(0,d.jsx)(O.C5,{})]})}),"installments"===v&&(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium",children:"N\xfamero de Cuotas *"}),(0,d.jsxs)(q.l6,{value:m.toString(),onValueChange:a=>n(Number(a)),children:[(0,d.jsx)(q.bq,{children:(0,d.jsx)(q.yv,{placeholder:"Seleccionar cuotas"})}),(0,d.jsx)(q.gC,{children:[2,3,4,5,6,7,8,9,10,12].map(a=>(0,d.jsxs)(q.eb,{value:a.toString(),children:[a," cuotas"]},a))})]})]}),(0,d.jsx)("div",{className:"flex items-end",children:(0,d.jsx)(g.$,{type:"button",variant:"outline",onClick:B,className:"w-full",children:"Recalcular Cuotas"})})]}),"installments"===v&&(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("h4",{className:"font-medium",children:["Cronograma de Cuotas (",i.length," cuotas)"]}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[0!==F&&(0,d.jsxs)(w.E,{variant:F>0?"destructive":"secondary",children:[F>0?"Faltan":"Sobran",": ",Math.abs(F).toFixed(2)]}),(0,d.jsxs)(g.$,{type:"button",variant:"outline",size:"sm",onClick:()=>{let a={description:`Cuota ${i.length+1}`,amount:0,dueDate:new Date},b=[...i,a];j(b),u.setValue("installments",b)},children:[(0,d.jsx)(l.A,{className:"h-4 w-4 mr-2"}),"Agregar Cuota"]})]})]}),(0,d.jsx)("div",{className:"space-y-3",children:i.map((a,b)=>(0,d.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,d.jsxs)("h5",{className:"font-medium",children:["Cuota ",b+1]}),i.length>1&&(0,d.jsx)(g.$,{type:"button",variant:"outline",size:"sm",onClick:()=>(a=>{let b=i.filter((b,c)=>c!==a);j(b),u.setValue("installments",b)})(b),children:(0,d.jsx)(x.A,{className:"h-4 w-4"})})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium",children:"Descripci\xf3n"}),(0,d.jsx)(p.p,{value:a.description,onChange:a=>C(b,"description",a.target.value),placeholder:"Descripci\xf3n de la cuota"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium",children:"Monto"}),(0,d.jsx)(p.p,{type:"number",value:a.amount,onChange:a=>C(b,"amount",Number(a.target.value)),placeholder:"0.00"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium",children:"Fecha de Vencimiento"}),(0,d.jsx)(ak.J3,{value:a.dueDate,onChange:a=>C(b,"dueDate",a),placeholder:"Seleccionar fecha"})]})]})]},b))}),i.length>0&&(0,d.jsx)("div",{className:"p-4 bg-muted/50 rounded-lg",children:(0,d.jsxs)("div",{className:"flex justify-between items-center",children:[(0,d.jsx)("span",{className:"font-medium",children:"Total en Cuotas:"}),(0,d.jsxs)("span",{className:"font-bold",children:[E.toFixed(2)," ",u.watch("currency")]})]})})]})]})]}),(0,d.jsxs)("div",{className:"flex justify-between",children:[(0,d.jsx)(g.$,{type:"button",variant:"outline",onClick:c,children:"Anterior: Entregables"}),(0,d.jsx)(g.$,{type:"submit",disabled:"installments"===v&&0!==F,children:"Siguiente: Resumen"})]})]})})]})},aC=({onSuccess:a,onCancel:b,open:c,onOpenChange:e,initialData:f,onSubmit:h})=>{let[i,j]=(0,k.useState)(1),[l,o]=(0,k.useState)(f||{}),p=(0,n.U0)(),{data:q}=(0,aj.kp)({limit:1e3}),s=q?.data?.find(a=>a.id===l.collaboratorId),t=[{number:1,title:"Informaci\xf3n B\xe1sica",icon:ad.A,description:"Datos del contrato y participantes"},{number:2,title:"Entregables",icon:u.A,description:"Selecci\xf3n de entregables"},{number:3,title:"Fechas y Pagos",icon:ae.A,description:"Cronograma y configuraci\xf3n financiera"},{number:4,title:"Resumen",icon:A.A,description:"Revisi\xf3n final antes de crear"}],v=a=>{o(b=>({...b,...a})),j(2)},x=a=>{o(b=>({...b,...a})),j(3)},y=a=>{o(b=>({...b,...a})),j(4)},z=async()=>{if(l&&B(l))try{let b=C(l);await p.mutateAsync(b),a?.(),h?.(l),D()}catch(a){console.error("Error al crear el contrato:",a)}},B=a=>!!(a.serviceId&&a.name&&a.university&&a.career&&a.collaboratorId&&a.researchClientIds?.length&&a.deliverableIds?.length&&a.costTotal&&a.currency&&a.startDate&&a.endDate),C=a=>{let b=[a.collaboratorId,...a.researchClientIds];return{serviceId:a.serviceId,name:a.name,university:a.university,career:a.career,observation:a.observation||"",costTotal:Number(a.costTotal),currency:a.currency,startDate:a.startDate.toISOString(),endDate:a.endDate.toISOString(),userIds:b,deliverableIds:a.deliverableIds,installments:a.installments?.map(a=>({description:a.description,amount:Number(a.amount),dueDate:a.dueDate.toISOString()}))||[],collaboratorPayments:a.collaboratorPayments?.map(a=>({userId:a.userId,amount:Number(a.amount),dueDate:a.dueDate.toISOString(),description:a.description}))||void 0}},D=()=>{j(1),o(f||{}),e?.(!1),b?.()},E=(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsx)("div",{className:"flex flex-col sm:flex-row items-center justify-center sm:justify-between mb-8 px-2 sm:px-4 space-y-4 sm:space-y-0",children:t.map((a,b)=>{let c=a.icon,e=i===a.number,f=i>a.number,g=a.number<=i||1===a.number;return(0,d.jsxs)("div",{className:"flex items-center flex-1 w-full sm:w-auto",children:[(0,d.jsxs)("div",{className:"flex flex-col items-center w-full sm:w-auto",children:[(0,d.jsx)("button",{onClick:()=>g&&(a=>{(a<=i||1===a)&&j(a)})(a.number),disabled:!g,className:`
                  flex items-center justify-center w-10 h-10 sm:w-12 sm:h-12 rounded-full border-2 transition-all
                  ${f?"bg-green-500 border-green-500 text-white":e?"bg-primary border-primary text-primary-foreground":g?"bg-background border-muted-foreground text-muted-foreground hover:border-primary hover:text-primary":"bg-muted border-muted text-muted-foreground cursor-not-allowed"}
                `,children:f?(0,d.jsx)(af.A,{className:"h-4 w-4 sm:h-5 sm:w-5"}):(0,d.jsx)(c,{className:"h-4 w-4 sm:h-5 sm:w-5"})}),(0,d.jsxs)("div",{className:"mt-1 sm:mt-2 text-center max-w-20 sm:max-w-none",children:[(0,d.jsx)("div",{className:`text-xs sm:text-sm font-medium ${e?"text-primary":"text-muted-foreground"}`,children:a.title}),(0,d.jsx)("div",{className:"text-xs text-muted-foreground hidden lg:block",children:a.description})]})]}),b<t.length-1&&(0,d.jsx)("div",{className:`hidden sm:block flex-1 h-0.5 mx-2 sm:mx-4 ${f?"bg-green-500":"bg-muted"}`})]},a.number)})}),(()=>{switch(i){case 1:return(0,d.jsx)(aq,{initialData:{serviceId:l.serviceId||"",name:l.name||"",university:l.university||"",career:l.career||"",observation:l.observation||"",collaboratorId:l.collaboratorId||"",researchClientIds:l.researchClientIds||[]},onNext:v});case 2:return(0,d.jsx)(aw,{serviceId:l.serviceId||"",initialData:{deliverableIds:l.deliverableIds||[]},onNext:x,onBack:()=>j(1)});case 3:return(0,d.jsx)(aB,{initialData:l,onNext:y,onBack:()=>j(2),collaboratorId:l.collaboratorId,collaboratorRole:s?.role,contractName:l.name});case 4:return(0,d.jsxs)("div",{className:"space-y-6 sm:space-y-8 max-w-6xl mx-auto px-4 sm:px-0",children:[(0,d.jsxs)("div",{className:"text-center space-y-4",children:[(0,d.jsx)("div",{className:"inline-flex items-center justify-center w-12 h-12 sm:w-16 sm:h-16 bg-primary/10 rounded-full mb-4",children:(0,d.jsx)(A.A,{className:"h-6 w-6 sm:h-8 sm:w-8 text-primary"})}),(0,d.jsx)("h2",{className:"text-2xl sm:text-3xl font-bold",children:"Resumen del Contrato"}),(0,d.jsx)("p",{className:"text-muted-foreground text-base sm:text-lg max-w-2xl mx-auto px-4 sm:px-0",children:"Revise cuidadosamente toda la informaci\xf3n antes de crear el contrato"})]}),(0,d.jsx)("div",{className:"bg-gradient-to-r from-primary/5 to-primary/10 rounded-lg p-4 sm:p-6 border border-primary/20",children:(0,d.jsxs)("div",{className:"text-center space-y-2",children:[(0,d.jsx)("h3",{className:"text-xl sm:text-2xl font-bold text-primary",children:l.name}),(0,d.jsxs)("p",{className:"text-base sm:text-lg text-muted-foreground",children:[l.university," - ",l.career]}),(0,d.jsx)("div",{className:"inline-flex items-center gap-2 mt-4 px-3 sm:px-4 py-2 bg-primary text-primary-foreground rounded-full",children:(0,d.jsxs)("span",{className:"text-lg sm:text-2xl font-bold",children:[l.costTotal," ",l.currency]})})]})}),(0,d.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-2",children:[(0,d.jsx)(r.Zp,{className:"h-fit",children:(0,d.jsxs)(r.Wu,{className:"p-6",children:[(0,d.jsxs)("h3",{className:"font-semibold mb-6 flex items-center gap-2 text-lg",children:[(0,d.jsx)(ad.A,{className:"h-5 w-5 text-primary"}),"Informaci\xf3n del Contrato"]}),(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"flex justify-between items-start",children:[(0,d.jsx)("span",{className:"font-medium text-muted-foreground",children:"Servicio:"}),(0,d.jsx)("span",{className:"text-right max-w-xs",children:l.serviceId})]}),(0,d.jsxs)("div",{className:"flex justify-between items-start",children:[(0,d.jsx)("span",{className:"font-medium text-muted-foreground",children:"Universidad:"}),(0,d.jsx)("span",{className:"text-right max-w-xs",children:l.university})]}),(0,d.jsxs)("div",{className:"flex justify-between items-start",children:[(0,d.jsx)("span",{className:"font-medium text-muted-foreground",children:"Carrera:"}),(0,d.jsx)("span",{className:"text-right max-w-xs",children:l.career})]}),l.observation&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("hr",{className:"my-4"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"font-medium text-muted-foreground block mb-2",children:"Observaciones:"}),(0,d.jsx)("p",{className:"text-sm text-muted-foreground bg-muted/50 p-3 rounded-md",children:l.observation})]})]})]})]})}),(0,d.jsx)(r.Zp,{className:"h-fit",children:(0,d.jsxs)(r.Wu,{className:"p-6",children:[(0,d.jsxs)("h3",{className:"font-semibold mb-6 flex items-center gap-2 text-lg",children:[(0,d.jsx)(ag.A,{className:"h-5 w-5 text-primary"}),"Participantes"]}),(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,d.jsx)(ah.A,{className:"h-4 w-4 text-muted-foreground"}),(0,d.jsx)("span",{className:"font-medium text-muted-foreground",children:"Colaborador Responsable"})]}),(0,d.jsx)(w.E,{variant:"outline",className:"ml-6",children:"1 colaborador"})]}),(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,d.jsx)(ag.A,{className:"h-4 w-4 text-muted-foreground"}),(0,d.jsx)("span",{className:"font-medium text-muted-foreground",children:"Clientes de Investigaci\xf3n"})]}),(0,d.jsxs)(w.E,{variant:"outline",className:"ml-6",children:[l.researchClientIds?.length||0," clientes"]})]})]})]})}),(0,d.jsx)(r.Zp,{className:"h-fit",children:(0,d.jsxs)(r.Wu,{className:"p-6",children:[(0,d.jsxs)("h3",{className:"font-semibold mb-6 flex items-center gap-2 text-lg",children:[(0,d.jsx)(u.A,{className:"h-5 w-5 text-primary"}),"Entregables del Proyecto"]}),(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{className:"text-muted-foreground",children:"Total de entregables:"}),(0,d.jsx)(w.E,{variant:"secondary",className:"text-lg px-3 py-1",children:l.deliverableIds?.length||0})]})]})}),(0,d.jsx)(r.Zp,{className:"h-fit",children:(0,d.jsxs)(r.Wu,{className:"p-6",children:[(0,d.jsxs)("h3",{className:"font-semibold mb-6 flex items-center gap-2 text-lg",children:[(0,d.jsx)(ae.A,{className:"h-5 w-5 text-primary"}),"Cronograma y Pagos"]}),(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsx)("span",{className:"font-medium text-muted-foreground block",children:"Fecha de Inicio"}),(0,d.jsx)("span",{className:"text-lg",children:l.startDate?.toLocaleDateString()})]}),(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsx)("span",{className:"font-medium text-muted-foreground block",children:"Fecha de Fin"}),(0,d.jsx)("span",{className:"text-lg",children:l.endDate?.toLocaleDateString()})]})]}),(0,d.jsx)("hr",{}),(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{className:"font-medium text-muted-foreground",children:"Modalidad de Pago:"}),(0,d.jsx)(w.E,{variant:"cash"===l.paymentType?"default":"secondary",children:"cash"===l.paymentType?"Pago al Contado":`${l.installments?.length||0} Cuotas`})]})]})]})})]}),"installments"===l.paymentType&&l.installments&&(0,d.jsx)(r.Zp,{children:(0,d.jsxs)(r.Wu,{className:"p-6",children:[(0,d.jsxs)("h3",{className:"font-semibold mb-6 flex items-center gap-2 text-lg",children:[(0,d.jsx)(ai.A,{className:"h-5 w-5 text-primary"}),"Cronograma de Cuotas"]}),(0,d.jsx)("div",{className:"grid gap-3 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3",children:l.installments.map((a,b)=>(0,d.jsxs)("div",{className:"border rounded-lg p-4 hover:bg-muted/50 transition-colors",children:[(0,d.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,d.jsx)(w.E,{variant:"outline",className:"text-xs",children:a.description})}),(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsxs)("div",{className:"text-xl font-bold text-primary",children:[a.amount.toFixed(2)," ",l.currency]}),(0,d.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Vence: ",a.dueDate.toLocaleDateString()]})]})]},b))}),(0,d.jsx)("div",{className:"mt-6 p-4 bg-muted/50 rounded-lg",children:(0,d.jsxs)("div",{className:"flex justify-between items-center text-lg font-semibold",children:[(0,d.jsx)("span",{children:"Total del Contrato:"}),(0,d.jsxs)("span",{className:"text-primary",children:[l.installments.reduce((a,b)=>a+b.amount,0).toFixed(2)," ",l.currency]})]})})]})}),(0,d.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 sm:justify-between pt-8 border-t",children:[(0,d.jsx)(g.$,{variant:"outline",onClick:()=>j(3),size:"lg",className:"w-full sm:w-auto",children:"Anterior: Fechas y Pagos"}),(0,d.jsx)(g.$,{onClick:z,disabled:p.isPending,className:"text-white w-full sm:w-auto",size:"lg",children:p.isPending?"Procesando...":"Crear Contrato"})]})]});default:return null}})()]});return void 0!==c&&e?(0,d.jsx)(m.lG,{open:c,onOpenChange:e,children:(0,d.jsxs)(m.Cf,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[(0,d.jsx)(m.c7,{className:"border-b pb-4",children:(0,d.jsx)(m.L3,{className:"text-xl",children:"Crear Nuevo Contrato"})}),(0,d.jsx)("div",{className:"py-6",children:E})]})}):E};function aD(){let[a,b]=(0,k.useState)({page:1,limit:10}),[c,e]=(0,k.useState)({open:!1,contractId:null,contractName:null}),[f,h]=(0,k.useState)({open:!1}),{data:i,isLoading:j,error:o,refetch:p}=(0,n.n)(a),q=(0,n.n9)(),r=(0,k.useMemo)(()=>i?.data||[],[i?.data]),s=i?.meta,u=(0,k.useCallback)(a=>{b(b=>({...b,page:a}))},[]),v=(0,k.useCallback)(a=>{b(b=>({...b,limit:a,page:1}))},[]),w=(0,k.useCallback)(a=>{b(b=>({...b,...a,page:1}))},[]),x=(0,k.useCallback)(()=>{b({page:1,limit:10})},[]),y=()=>{h({open:!1})},z=(0,k.useCallback)(a=>{let b=r.find(b=>b.id===a);e({open:!0,contractId:a,contractName:b?.name||null})},[r]),A=(0,k.useCallback)(async()=>{if(c.contractId)try{await q.mutateAsync(c.contractId),e({open:!1,contractId:null,contractName:null})}catch(a){console.error("Error eliminando contrato:",a)}},[c.contractId,q]),B={totalContracts:s?.total||r.length,activeContracts:r.filter(a=>a.overallProgress<100).length,completedContracts:r.filter(a=>100===a.overallProgress).length,thisMonthContracts:0,totalRevenue:r.reduce((a,b)=>a+b.costTotal,0),avgProgress:r.length>0?Math.round(r.reduce((a,b)=>a+b.overallProgress,0)/r.length):0};return o?(0,d.jsxs)("div",{className:"flex flex-col items-center justify-center p-8 text-center",children:[(0,d.jsx)("p",{className:"text-lg text-red-600 mb-4",children:"Error al cargar los contratos"}),(0,d.jsx)(g.$,{onClick:()=>p(),variant:"outline",children:"Intentar nuevamente"})]}):(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Gesti\xf3n de Proyectos"}),(0,d.jsx)("p",{className:"text-muted-foreground",children:"Administra y supervisa todos los contratos de proyectos"})]}),(0,d.jsxs)(g.$,{onClick:()=>{h({open:!0})},className:"text-white",children:[(0,d.jsx)(l.A,{className:"mr-2 h-4 w-4"}),"Nuevo Proyecto"]})]}),(0,d.jsx)(aa,{data:B}),(0,d.jsx)(t,{filters:a,onFiltersChange:w,onClearFilters:x}),(0,d.jsx)("div",{className:"space-y-4",children:(0,d.jsx)(Z,{data:r,isLoading:j,onDelete:z,serverPagination:!0,paginationMeta:s,onPageChange:u,onPageSizeChange:v})}),(0,d.jsx)(ac,{open:c.open,onOpenChange:a=>e(b=>({...b,open:a})),onConfirm:A,contractName:c.contractName||void 0,isLoading:q.isPending}),(0,d.jsx)(m.lG,{open:f.open,onOpenChange:a=>{a||y()},children:(0,d.jsxs)(m.Cf,{className:"max-w-[95vw] w-[95vw] max-h-[85vh] overflow-y-auto",style:{width:"80vw",maxWidth:"70vw"},children:[(0,d.jsx)(m.c7,{children:(0,d.jsx)(m.L3,{children:"Nuevo Contrato"})}),(0,d.jsx)(aC,{onSuccess:()=>{y(),p()},onCancel:y})]})})]})}function aE(){return(0,d.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col",children:[(0,d.jsxs)("header",{className:"bg-background/60 backdrop-blur-md sticky top-0 z-50 flex h-12 shrink-0 items-center gap-2 border-b px-4",children:[(0,d.jsx)(i.SidebarTrigger,{className:"-ml-1"}),(0,d.jsx)(h.Separator,{orientation:"vertical",className:"mr-2 h-4"}),(0,d.jsx)("div",{className:"flex items-center gap-2",children:(0,d.jsx)(f.Qp,{children:(0,d.jsx)(f.AB,{children:(0,d.jsx)(f.J5,{children:(0,d.jsx)(f.tJ,{children:"Gesti\xf3n de Proyectos"})})})})}),(0,d.jsxs)("div",{className:"ml-auto mr-4",children:[(0,d.jsx)(e.default,{}),(0,d.jsx)(g.$,{variant:"ghost",size:"icon","aria-label":"Notificaciones",className:"mr-2",children:(0,d.jsx)(j.A,{className:"h-5 w-5"})})]})]}),(0,d.jsx)("div",{className:"flex flex-1 flex-col gap-6 p-4 md:p-6",children:(0,d.jsx)(aD,{})})]})}c(61714)},83934:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>d});let d=(0,c(61369).registerClientReference)(function(){throw Error("Attempted to call the default export of \"D:\\\\ECOMAS\\\\testing\\\\crud-alvaro\\\\cecagem\\\\cecagem-frontend2\\\\src\\\\app\\\\(admin)\\\\contract\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"D:\\ECOMAS\\testing\\crud-alvaro\\cecagem\\cecagem-frontend2\\src\\app\\(admin)\\contract\\page.tsx","default")},83997:a=>{"use strict";a.exports=require("tty")},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},90181:(a,b,c)=>{Promise.resolve().then(c.bind(c,82410))},94735:a=>{"use strict";a.exports=require("events")}};var b=require("../../../webpack-runtime.js");b.C(a);var c=b.X(0,[985,12,852,608,30,403,275,64,662,692,982,145,690,321,436],()=>b(b.s=61944));module.exports=c})();